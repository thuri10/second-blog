<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Understanding Firebase, local Sqlite and AWS storage security weaknesses.'><title>Android Application Security Part2</title>

<link rel='canonical' href='https://thuri10.github.io/p/firebase/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Android Application Security Part2'>
<meta property='og:description' content='Understanding Firebase, local Sqlite and AWS storage security weaknesses.'>
<meta property='og:url' content='https://thuri10.github.io/p/firebase/'>
<meta property='og:site_name' content='Solar Bits'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Android' /><meta property='article:tag' content='Appsec' /><meta property='article:published_time' content='2021-10-25T15:53:55&#43;03:00'/><meta property='article:modified_time' content='2021-10-25T15:53:55&#43;03:00'/><meta property='og:image' content='https://thuri10.github.io/firebase.jpg' />
<meta name="twitter:title" content="Android Application Security Part2">
<meta name="twitter:description" content="Understanding Firebase, local Sqlite and AWS storage security weaknesses."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://thuri10.github.io/firebase.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/firebase/">
                
                    <img src="/firebase.jpg" loading="lazy" alt="Featured image of post Android Application Security Part2" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/firebase/">Android Application Security Part2</a>
    </h2>

    
    <h3 class="article-subtitle">
        Understanding Firebase, local Sqlite and AWS storage security weaknesses.
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Oct 25, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="insecure-storages">Insecure Storages</h2>
<p>This is the second part of the android application security. This part focuses on the local sqlite databases, firebase and AWS security.</p>
<h3 id="flag7---sqlite">Flag7 - Sqlite</h3>
<p>This is level is about understanding the sqlite local database in the applications folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">FlagSevenSqliteActivity</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> bArr <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">x</span><span style="color:#ff79c6">;</span>      <span style="color:#6272a4">//sqlite
</span><span style="color:#6272a4"></span>        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>bArr<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;decodedDirectoryOne&#34;</span><span style="color:#ff79c6">);</span>
        Charset charset <span style="color:#ff79c6">=</span> StandardCharsets<span style="color:#ff79c6">.</span><span style="color:#50fa7b">UTF_8</span><span style="color:#ff79c6">;</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>charset<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;StandardCharsets.UTF_8&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">z</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> String<span style="color:#ff79c6">(</span>bArr<span style="color:#ff79c6">,</span> charset<span style="color:#ff79c6">);</span>
        <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> bArr2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">y</span><span style="color:#ff79c6">;</span>        <span style="color:#6272a4">//f1ag-pa55
</span><span style="color:#6272a4"></span>        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>bArr2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;decodedDirectoryTwo&#34;</span><span style="color:#ff79c6">);</span>
        Charset charset2 <span style="color:#ff79c6">=</span> StandardCharsets<span style="color:#ff79c6">.</span><span style="color:#50fa7b">UTF_8</span><span style="color:#ff79c6">;</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>charset2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;StandardCharsets.UTF_8&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">A</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> String<span style="color:#ff79c6">(</span>bArr2<span style="color:#ff79c6">,</span> charset2<span style="color:#ff79c6">);</span>
        f b2 <span style="color:#ff79c6">=</span> f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">();</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>b2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;FirebaseDatabase.getInstance()&#34;</span><span style="color:#ff79c6">);</span>
        d d2 <span style="color:#ff79c6">=</span> b2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">();</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>d2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;FirebaseDatabase.getInstance().reference&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">B</span> <span style="color:#ff79c6">=</span> d2<span style="color:#ff79c6">;</span>
        d h <span style="color:#ff79c6">=</span> d2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">h</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">z</span><span style="color:#ff79c6">);</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>h<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;database.child(refDirectory)&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">C</span> <span style="color:#ff79c6">=</span> h<span style="color:#ff79c6">;</span>
        d h2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">B</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">h</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">A</span><span style="color:#ff79c6">);</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>h2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;database.child(refDirectoryTwo)&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">D</span> <span style="color:#ff79c6">=</span> h2<span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span>

</code></pre></div><p>on looking at the oncreate method define in the flag7 activity.from the code below , we are creating a database called Thisislatest.db</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onCreate</span><span style="color:#ff79c6">(</span>Bundle bundle<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">super</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">onCreate</span><span style="color:#ff79c6">(</span>bundle<span style="color:#ff79c6">);</span>
    setContentView<span style="color:#ff79c6">(</span>R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">layout</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">activity_flag_seven_sqlite</span><span style="color:#ff79c6">);</span>
    C<span style="color:#ff79c6">((</span>Toolbar<span style="color:#ff79c6">)</span> findViewById<span style="color:#ff79c6">(</span>R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">toolbar</span><span style="color:#ff79c6">));</span>
    j<span style="color:#ff79c6">.</span><span style="color:#50fa7b">g</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">a</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
    H<span style="color:#ff79c6">();</span>
    <span style="color:#ff79c6">((</span>FloatingActionButton<span style="color:#ff79c6">)</span> findViewById<span style="color:#ff79c6">(</span>R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">id</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">fab</span><span style="color:#ff79c6">)).</span><span style="color:#50fa7b">setOnClickListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> a<span style="color:#ff79c6">());</span>
    SQLiteDatabase writableDatabase <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">u</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">getWritableDatabase</span><span style="color:#ff79c6">();</span>
    ContentValues contentValues <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ContentValues<span style="color:#ff79c6">();</span>
    contentValues<span style="color:#ff79c6">.</span><span style="color:#50fa7b">put</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;title&#34;</span><span style="color:#ff79c6">,</span> Base64<span style="color:#ff79c6">.</span><span style="color:#50fa7b">decode</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;VGhlIGZsYWcgaGFzaCE=&#34;</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">));</span>
    contentValues<span style="color:#ff79c6">.</span><span style="color:#50fa7b">put</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;subtitle&#34;</span><span style="color:#ff79c6">,</span> Base64<span style="color:#ff79c6">.</span><span style="color:#50fa7b">decode</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc=&#34;</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">));</span>
    writableDatabase<span style="color:#ff79c6">.</span><span style="color:#50fa7b">insert</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Thisisatest&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> contentValues<span style="color:#ff79c6">);</span>
    contentValues<span style="color:#ff79c6">.</span><span style="color:#50fa7b">put</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;title&#34;</span><span style="color:#ff79c6">,</span> Base64<span style="color:#ff79c6">.</span><span style="color:#50fa7b">decode</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ==&#34;</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">));</span>
    contentValues<span style="color:#ff79c6">.</span><span style="color:#50fa7b">put</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;subtitle&#34;</span><span style="color:#ff79c6">,</span> h<span style="color:#ff79c6">.</span><span style="color:#50fa7b">c</span><span style="color:#ff79c6">());</span>
    writableDatabase<span style="color:#ff79c6">.</span><span style="color:#50fa7b">insert</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Thisisatest&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> contentValues<span style="color:#ff79c6">);</span>
<span style="color:#ff79c6">}</span>
</code></pre></div><h3 id="flag8---aws-storage-and-security">FLag8 - AWS Storage and Security.</h3>
<p>This level is about learing AWS storage and security.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">FlagEightLoginActivity</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
    f b2 <span style="color:#ff79c6">=</span> f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">();</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>b2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;FirebaseDatabase.getInstance()&#34;</span><span style="color:#ff79c6">);</span>
    d d2 <span style="color:#ff79c6">=</span> b2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">();</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>d2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;FirebaseDatabase.getInstance().reference&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">u</span> <span style="color:#ff79c6">=</span> d2<span style="color:#ff79c6">;</span>
    d h <span style="color:#ff79c6">=</span> d2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">h</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;/aws&#34;</span><span style="color:#ff79c6">);</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>h<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;database.child(\&#34;/aws\&#34;)&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">v</span> <span style="color:#ff79c6">=</span> h<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">}</span>

</code></pre></div><p>clicking on the  onclick method in the source code., as shown in the code snippet below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">final</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">(</span>View view<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>FlagEightLoginActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">H</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">==</span> 0<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>view <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
            Snackbar X <span style="color:#ff79c6">=</span> Snackbar<span style="color:#ff79c6">.</span><span style="color:#50fa7b">X</span><span style="color:#ff79c6">(</span>view<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;AWS CLI.&#34;</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">);</span>
            X<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Y</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Action&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">);</span>
            X<span style="color:#ff79c6">.</span><span style="color:#50fa7b">N</span><span style="color:#ff79c6">();</span>
            FlagEightLoginActivity flagEightLoginActivity <span style="color:#ff79c6">=</span> FlagEightLoginActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">;</span>
            flagEightLoginActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">I</span><span style="color:#ff79c6">(</span>flagEightLoginActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">H</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> 1<span style="color:#ff79c6">);</span>
            <span style="color:#ff79c6">return</span><span style="color:#ff79c6">;</span>
        <span style="color:#ff79c6">}</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">k</span><span style="color:#ff79c6">();</span>
        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>FlagEightLoginActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">H</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">!=</span> 1<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">{</span>
        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>view <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
            Snackbar X2 <span style="color:#ff79c6">=</span> Snackbar<span style="color:#ff79c6">.</span><span style="color:#50fa7b">X</span><span style="color:#ff79c6">(</span>view<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;AWS profiles and credentials.&#34;</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">);</span>
            X2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Y</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Action&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">);</span>
            X2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">N</span><span style="color:#ff79c6">();</span>
            FlagEightLoginActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">I</span><span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">);</span>
            <span style="color:#ff79c6">return</span><span style="color:#ff79c6">;</span>
        <span style="color:#ff79c6">}</span>
        d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">k</span><span style="color:#ff79c6">();</span>
        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span>

</code></pre></div><p>from the hint above on to use AWS CLI. Now let look for AWS profiles and credentials in the application.</p>
<p>Most of the strings in an android application are located at the strings.xml file in the res directory.
in the strings.xml file we have two intresting strings as shown in the code snippet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#ff79c6">&lt;string</span> <span style="color:#50fa7b">name=</span><span style="color:#f1fa8c">&#34;AWS_ID&#34;</span><span style="color:#ff79c6">&gt;</span>AKIAZ36DGKTUIOLDOBN6<span style="color:#ff79c6">&lt;/string&gt;</span>
<span style="color:#ff79c6">&lt;string</span> <span style="color:#50fa7b">name=</span><span style="color:#f1fa8c">&#34;AWS_SECRET&#34;</span><span style="color:#ff79c6">&gt;</span>KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S<span style="color:#ff79c6">&lt;/string&gt;</span>

</code></pre></div><p>show how to use AWS cli to get the flag.</p>
<h3 id="flag9--firebase">Flag9- FireBase</h3>
<p>This challenge is about understanding firebase realtime database rules.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">final</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">goToFlagNineFirebaseActivity</span><span style="color:#ff79c6">(</span>View view<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
        startActivity<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Intent<span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">,</span> FlagNineFirebaseActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">class</span><span style="color:#ff79c6">));</span>
    <span style="color:#ff79c6">}</span>

</code></pre></div><p>We start  our analysis in the main activity, for the level nine is defined in FlagNineFirebaseActivity. Let analyze the level nine security.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">FlagNineFirebaseActivity</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> decode <span style="color:#ff79c6">=</span> Base64<span style="color:#ff79c6">.</span><span style="color:#50fa7b">decode</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;ZmxhZ3Mv&#34;</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">);</span>     <span style="color:#6272a4">//  flags/ 
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">v</span> <span style="color:#ff79c6">=</span> decode<span style="color:#ff79c6">;</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>decode<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;decodedDirectory&#34;</span><span style="color:#ff79c6">);</span>
    Charset charset <span style="color:#ff79c6">=</span> StandardCharsets<span style="color:#ff79c6">.</span><span style="color:#50fa7b">UTF_8</span><span style="color:#ff79c6">;</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>charset<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;StandardCharsets.UTF_8&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">w</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> String<span style="color:#ff79c6">(</span>decode<span style="color:#ff79c6">,</span> charset<span style="color:#ff79c6">);</span>
    f b2 <span style="color:#ff79c6">=</span> f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">();</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>b2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;FirebaseDatabase.getInstance()&#34;</span><span style="color:#ff79c6">);</span>
    d d2 <span style="color:#ff79c6">=</span> b2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">();</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>d2<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;FirebaseDatabase.getInstance().reference&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">x</span> <span style="color:#ff79c6">=</span> d2<span style="color:#ff79c6">;</span>
    d h <span style="color:#ff79c6">=</span> d2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">h</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">w</span><span style="color:#ff79c6">);</span>
    d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">(</span>h<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;database.child(refDirectory)&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">y</span> <span style="color:#ff79c6">=</span> h<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">}</span>
</code></pre></div><p>we can decode the base64 encoded strings in the above code to understand what is happening as shown in the code above.</p>
<p>clicking on the hint button, we get an hint on what to do as shown in the code below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">final</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">(</span>View view<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
        String str<span style="color:#ff79c6">;</span>
        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>FlagNineFirebaseActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">H</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">==</span> 0<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
            <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>view <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
                str <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Use the .json trick with database url&#34;</span><span style="color:#ff79c6">;</span>
            <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">{</span>
                d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">k</span><span style="color:#ff79c6">();</span>
                <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
            <span style="color:#ff79c6">}</span>
        <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>FlagNineFirebaseActivity<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">H</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">==</span> 1<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
            <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>view <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
                str <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Filenames.&#34;</span><span style="color:#ff79c6">;</span>
            <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">{</span>
                d<span style="color:#ff79c6">.</span><span style="color:#50fa7b">m</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">b</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">k</span><span style="color:#ff79c6">();</span>
                <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
            <span style="color:#ff79c6">}</span>

</code></pre></div><p>let now look for the database url in the strings.xml</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#ff79c6">&lt;string</span> <span style="color:#50fa7b">name=</span><span style="color:#f1fa8c">&#34;firebase_database_url&#34;</span><span style="color:#ff79c6">&gt;</span>https://injuredandroid.firebaseio.com<span style="color:#ff79c6">&lt;/string&gt;</span>
</code></pre></div><p>the firebase node we are interested is the flags node. to check if the endpoint or the node is vulnerable is to add a .json as shown in the image below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">vx@archie:injured$ curl https://injuredandroid.firebaseio.com/flags/.json
<span style="color:#f1fa8c">&#34;[nine!_flag]&#34;</span>
</code></pre></div><p>Adding a .json extension in our url, we get a flag for our application.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/android/">Android</a>
        
            <a href="/tags/appsec/">Appsec</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/android-application-security-series-part-1/">
        
        
            <div class="article-image">
                
                    <img src="/android.jpg" loading="lazy" data-key="" data-hash="/android.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Android Application Security Series- Part 1</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2021 Solar Bits
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#insecure-storages">Insecure Storages</a>
      <ol>
        <li><a href="#flag7---sqlite">Flag7 - Sqlite</a></li>
        <li><a href="#flag8---aws-storage-and-security">FLag8 - AWS Storage and Security.</a></li>
        <li><a href="#flag9--firebase">Flag9- FireBase</a></li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
