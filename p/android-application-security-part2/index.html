<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Firebase, Local Sqlite and AWS storage security weaknesses.'><title>Android Application Security Part2</title>

<link rel='canonical' href='https://thuri10.github.io/p/android-application-security-part2/'>

<link rel="stylesheet" href="/scss/style.min.1b3ac667198cb83edcc9c45e606a6f4dd6910b8ada6b74d7fd988f1b2dfd0c7c.css"><meta property='og:title' content='Android Application Security Part2'>
<meta property='og:description' content='Firebase, Local Sqlite and AWS storage security weaknesses.'>
<meta property='og:url' content='https://thuri10.github.io/p/android-application-security-part2/'>
<meta property='og:site_name' content='Solar Bits'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Android' /><meta property='article:tag' content='Appsec' /><meta property='article:published_time' content='2021-10-25T15:53:55&#43;03:00'/><meta property='article:modified_time' content='2021-10-25T15:53:55&#43;03:00'/><meta property='og:image' content='https://thuri10.github.io/post/androidsec/firebase.jpg' />
<meta name="twitter:title" content="Android Application Security Part2">
<meta name="twitter:description" content="Firebase, Local Sqlite and AWS storage security weaknesses."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://thuri10.github.io/post/androidsec/firebase.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/android-application-security-part2/">
                
                    <img src="/post/androidsec/firebase.jpg" loading="lazy" alt="Featured image of post Android Application Security Part2" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/android-application-security-part2/">Android Application Security Part2</a>
    </h2>

    
    <h3 class="article-subtitle">
        Firebase, Local Sqlite and AWS storage security weaknesses.
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Oct 25, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    
    
    <h2 id="insecure-storages">Insecure Storages</h2>
<p>This is the second part series of the android application security. This part focuses on the security of sqlite databases, firebase and AWS security.</p>
<h3 id="flag7---sqlite">Flag7 - Sqlite</h3>
<p><strong>What is sqlite?</strong></p>
<p>Sqlite is a structure query base database that enables applications to do local storage in the application directory. The goal of the challenge is to understand how local storage of databases may lead to leakage of information.</p>
<p>First step is to decompile the FlagSevenSqliteActivity using jadx.</p>
<p>During the analysis of new android activity, we start analysis on the onCreate method.<strong>oncreate</strong> is the first method to be called by an application when an activity is started.</p>
<p>The decompiled oncreate method is as shown below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#815ba4">public</span> <span style="color:#fec418">void</span> <span style="color:#06b6ef">onCreate</span><span style="color:#5bc4bf">(</span>Bundle bundle<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
    <span style="color:#815ba4">super</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">onCreate</span><span style="color:#5bc4bf">(</span>bundle<span style="color:#5bc4bf">);</span>
    setContentView<span style="color:#5bc4bf">(</span>R<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">layout</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">activity_flag_seven_sqlite</span><span style="color:#5bc4bf">);</span>
    C<span style="color:#5bc4bf">((</span>Toolbar<span style="color:#5bc4bf">)</span> findViewById<span style="color:#5bc4bf">(</span>R<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">id</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">toolbar</span><span style="color:#5bc4bf">));</span>
    j<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">g</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">a</span><span style="color:#5bc4bf">(</span><span style="color:#815ba4">this</span><span style="color:#5bc4bf">);</span>
    H<span style="color:#5bc4bf">();</span>
    <span style="color:#5bc4bf">((</span>FloatingActionButton<span style="color:#5bc4bf">)</span> findViewById<span style="color:#5bc4bf">(</span>R<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">id</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">fab</span><span style="color:#5bc4bf">)).</span><span style="color:#06b6ef">setOnClickListener</span><span style="color:#5bc4bf">(</span><span style="color:#815ba4">new</span> a<span style="color:#5bc4bf">());</span>
    SQLiteDatabase writableDatabase <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">u</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">getWritableDatabase</span><span style="color:#5bc4bf">();</span>
    ContentValues contentValues <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">new</span> ContentValues<span style="color:#5bc4bf">();</span>
    contentValues<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">put</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;title&#34;</span><span style="color:#5bc4bf">,</span> Base64<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">decode</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;VGhlIGZsYWcgaGFzaCE=&#34;</span><span style="color:#5bc4bf">,</span> 0<span style="color:#5bc4bf">));</span>
    contentValues<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">put</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;subtitle&#34;</span><span style="color:#5bc4bf">,</span> Base64<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">decode</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc=&#34;</span><span style="color:#5bc4bf">,</span> 0<span style="color:#5bc4bf">));</span>
    writableDatabase<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">insert</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;Thisisatest&#34;</span><span style="color:#5bc4bf">,</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">,</span> contentValues<span style="color:#5bc4bf">);</span>
    contentValues<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">put</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;title&#34;</span><span style="color:#5bc4bf">,</span> Base64<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">decode</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ==&#34;</span><span style="color:#5bc4bf">,</span> 0<span style="color:#5bc4bf">));</span>
    contentValues<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">put</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;subtitle&#34;</span><span style="color:#5bc4bf">,</span> h<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">c</span><span style="color:#5bc4bf">());</span>
    writableDatabase<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">insert</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;Thisisatest&#34;</span><span style="color:#5bc4bf">,</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">,</span> contentValues<span style="color:#5bc4bf">);</span>
<span style="color:#5bc4bf">}</span>
</code></pre></div><p>From the analysis of the above code, the method is passing some base64 encoded strings and storing them into string variables.From the hint of application name, we are creating writable database through SQLiteDatabase functions. In this application we are writing some strings to the database. The name of the database being referenced is <strong>Thisisatest</strong> database.</p>
<p>Next step is decode all base64 encoded strings in order to understand the logic of the program. The decoded strings below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">VGhlIGZsYWcgaGFzaCE    - The flag hash! 
MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc - 2ab96390c7dbe3439de74d0c9b0b1767
VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ  - The flag is also a password!
</code></pre></div><p>The above decoded strings gives us an hint on solving the challenge. The author provides us with the hash of the flag.</p>
<p>The activity defines some interesting strings in the application, we decode the strings as shown in the code below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#815ba4">private</span> <span style="color:#815ba4">final</span> String w = <span style="color:#48b685">&#34;ZjFhZy1wYTU1&#34;</span>;   <span style="color:#ef6155">#</span>f1ag-pa55
<span style="color:#815ba4">private</span> byte[] x = Base64.decode(<span style="color:#48b685">&#34;c3FsaXRl&#34;</span>, <span style="color:#f99b15">0</span>);  <span style="color:#ef6155">#</span>sqlite
<span style="color:#815ba4">private</span> byte[] y = Base64.decode(<span style="color:#815ba4">this</span>.w, <span style="color:#f99b15">0</span>);
<span style="color:#815ba4">private</span> <span style="color:#815ba4">final</span> String z;
</code></pre></div><p>Next is to analyze the FlagSevensqliteActivity in order to understand the usage of the above strings in our activity. Important strings form the above are <strong>f1ag-pa55</strong> and <strong>sqlite</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">
    <span style="color:#815ba4">public</span> <span style="color:#06b6ef">FlagSevenSqliteActivity</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">{</span>
        <span style="color:#fec418">byte</span><span style="color:#5bc4bf">[]</span> bArr <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">x</span><span style="color:#5bc4bf">;</span>      <span style="color:#776e71">//sqlite
</span><span style="color:#776e71"></span>        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>bArr<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;decodedDirectoryOne&#34;</span><span style="color:#5bc4bf">);</span>
        Charset charset <span style="color:#5bc4bf">=</span> StandardCharsets<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">UTF_8</span><span style="color:#5bc4bf">;</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>charset<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;StandardCharsets.UTF_8&#34;</span><span style="color:#5bc4bf">);</span>
        <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">z</span> <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">new</span> String<span style="color:#5bc4bf">(</span>bArr<span style="color:#5bc4bf">,</span> charset<span style="color:#5bc4bf">);</span>
        <span style="color:#fec418">byte</span><span style="color:#5bc4bf">[]</span> bArr2 <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">y</span><span style="color:#5bc4bf">;</span>        <span style="color:#776e71">//f1ag-pa55
</span><span style="color:#776e71"></span>        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>bArr2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;decodedDirectoryTwo&#34;</span><span style="color:#5bc4bf">);</span>
        Charset charset2 <span style="color:#5bc4bf">=</span> StandardCharsets<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">UTF_8</span><span style="color:#5bc4bf">;</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>charset2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;StandardCharsets.UTF_8&#34;</span><span style="color:#5bc4bf">);</span>
        <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">A</span> <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">new</span> String<span style="color:#5bc4bf">(</span>bArr2<span style="color:#5bc4bf">,</span> charset2<span style="color:#5bc4bf">);</span>
        f b2 <span style="color:#5bc4bf">=</span> f<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">();</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>b2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;FirebaseDatabase.getInstance()&#34;</span><span style="color:#5bc4bf">);</span>
        d d2 <span style="color:#5bc4bf">=</span> b2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">();</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>d2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;FirebaseDatabase.getInstance().reference&#34;</span><span style="color:#5bc4bf">);</span>
        <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">B</span> <span style="color:#5bc4bf">=</span> d2<span style="color:#5bc4bf">;</span>
        d h <span style="color:#5bc4bf">=</span> d2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">h</span><span style="color:#5bc4bf">(</span><span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">z</span><span style="color:#5bc4bf">);</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>h<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;database.child(refDirectory)&#34;</span><span style="color:#5bc4bf">);</span>
        <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">C</span> <span style="color:#5bc4bf">=</span> h<span style="color:#5bc4bf">;</span>
        d h2 <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">B</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">h</span><span style="color:#5bc4bf">(</span><span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">A</span><span style="color:#5bc4bf">);</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>h2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;database.child(refDirectoryTwo)&#34;</span><span style="color:#5bc4bf">);</span>
        <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">D</span> <span style="color:#5bc4bf">=</span> h2<span style="color:#5bc4bf">;</span>
    <span style="color:#5bc4bf">}</span>

</code></pre></div><p>From the above decompiled <strong>flagSevensqliteActivity</strong>, shows how the application is parsing the data from the firebase instance. In order to understand the data we are fetching, we need to know the nodes we are fetching the data from. From the decompiled code, we are accessing the string x as shown in the constructor method in line 1 through bArr byte array. our string is then passed to variable z constructor method as referenced by <strong>this.z</strong> constructor.</p>
<p>This means, <strong>f1ag-pa55</strong> and <strong>sqlite</strong> are our firebase nodes.</p>
<p>To get the firebase link, we look for the link the <strong>strings.xml</strong> in the resources directory of the application.The link of the firebase url is shown in the image below. Manually test firebase endpoints manually to see if they are vulnerable as shown in the code below. Adding .json at the end of the firebase endpoint enables one to read data.</p>
<p>First we test our endpoint using <strong>sqlite</strong> node.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vx@archie:output$ curl https://injuredandroid.firebaseio.com/sqlite.json
<span style="color:#48b685">&#34;S3V3N_11&#34;</span>
</code></pre></div><p>From the results of the above, we get our flag. Accessing the endpoint using <strong>f1ag-pa55</strong> using .json firebase trick, we get our password.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vx@archie:output$ curl https://injuredandroid.firebaseio.com/f1ag-pa55.json
<span style="color:#48b685">&#34;hunter2&#34;</span>
</code></pre></div><p><strong>hunter2</strong> is our correct password for the challenge.</p>
<h3 id="flag8---aws-storage-and-security">FLag8 - AWS Storage and Security.</h3>
<p>This challenge is about understanding the misconfiguration of AWS storage and security implementation in the android applications.</p>
<p>The decompiled flagEightclass activity code looks like the one below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#815ba4">public</span> <span style="color:#06b6ef">FlagEightLoginActivity</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">{</span>
    f b2 <span style="color:#5bc4bf">=</span> f<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">();</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>b2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;FirebaseDatabase.getInstance()&#34;</span><span style="color:#5bc4bf">);</span>
    d d2 <span style="color:#5bc4bf">=</span> b2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">();</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>d2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;FirebaseDatabase.getInstance().reference&#34;</span><span style="color:#5bc4bf">);</span>
    <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">u</span> <span style="color:#5bc4bf">=</span> d2<span style="color:#5bc4bf">;</span>
    d h <span style="color:#5bc4bf">=</span> d2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">h</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;/aws&#34;</span><span style="color:#5bc4bf">);</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>h<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;database.child(\&#34;/aws\&#34;)&#34;</span><span style="color:#5bc4bf">);</span>
    <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">v</span> <span style="color:#5bc4bf">=</span> h<span style="color:#5bc4bf">;</span>
<span style="color:#5bc4bf">}</span>
</code></pre></div><p>The activity initializes firebase instance and fetches some information from the aws child node in the firebase storage model. Checking the above model if it is vulnerable to the .json trick of firebase, we get some information back as shown below</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vx@archie:ret2csu$ curl https://injuredandroid.firebaseio.com/aws.json
<span style="color:#48b685">&#34;C10ud_S3cur1ty_lol&#34;</span>
</code></pre></div><p>Next step is to analyze the onclick method of the application. This is the method that responds to events of an application that if you click an object defined by the in the code.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#815ba4">public</span> <span style="color:#815ba4">final</span> <span style="color:#fec418">void</span> <span style="color:#06b6ef">onClick</span><span style="color:#5bc4bf">(</span>View view<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
    <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>FlagEightLoginActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">H</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">==</span> 0<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
        <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>view <span style="color:#5bc4bf">!=</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
            Snackbar X <span style="color:#5bc4bf">=</span> Snackbar<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">X</span><span style="color:#5bc4bf">(</span>view<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;AWS CLI.&#34;</span><span style="color:#5bc4bf">,</span> 0<span style="color:#5bc4bf">);</span>
            X<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">Y</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;Action&#34;</span><span style="color:#5bc4bf">,</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">);</span>
            X<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">N</span><span style="color:#5bc4bf">();</span>
            FlagEightLoginActivity flagEightLoginActivity <span style="color:#5bc4bf">=</span> FlagEightLoginActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">this</span><span style="color:#5bc4bf">;</span>
            flagEightLoginActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">I</span><span style="color:#5bc4bf">(</span>flagEightLoginActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">H</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">+</span> 1<span style="color:#5bc4bf">);</span>
            <span style="color:#815ba4">return</span><span style="color:#5bc4bf">;</span>
        <span style="color:#5bc4bf">}</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">k</span><span style="color:#5bc4bf">();</span>
        <span style="color:#815ba4">throw</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">;</span>
    <span style="color:#5bc4bf">}</span> <span style="color:#815ba4">else</span> <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>FlagEightLoginActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">H</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">!=</span> 1<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
    <span style="color:#5bc4bf">}</span> <span style="color:#815ba4">else</span> <span style="color:#5bc4bf">{</span>
        <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>view <span style="color:#5bc4bf">!=</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
            Snackbar X2 <span style="color:#5bc4bf">=</span> Snackbar<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">X</span><span style="color:#5bc4bf">(</span>view<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;AWS profiles and credentials.&#34;</span><span style="color:#5bc4bf">,</span> 0<span style="color:#5bc4bf">);</span>
            X2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">Y</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;Action&#34;</span><span style="color:#5bc4bf">,</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">);</span>
            X2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">N</span><span style="color:#5bc4bf">();</span>
            FlagEightLoginActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">I</span><span style="color:#5bc4bf">(</span>0<span style="color:#5bc4bf">);</span>
            <span style="color:#815ba4">return</span><span style="color:#5bc4bf">;</span>
        <span style="color:#5bc4bf">}</span>
        d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">k</span><span style="color:#5bc4bf">();</span>
        <span style="color:#815ba4">throw</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">;</span>
    <span style="color:#5bc4bf">}</span>
<span style="color:#5bc4bf">}</span>

</code></pre></div><p>From the above hints provided in the application, gives hint on using of AWS CLI and understanding of AWS profiles and credentials.</p>
<p><strong>what are the AWS profile stored?</strong></p>
<p>Most of the strings are located in a file called <strong>strings.xml</strong> in the resources directory which are referenced throughout the application. In strings.xml file we have two interesting strings as shown in the code snippet below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#5bc4bf">&lt;string</span> <span style="color:#06b6ef">name=</span><span style="color:#48b685">&#34;AWS_ID&#34;</span><span style="color:#5bc4bf">&gt;</span>AKIAZ36DGKTUIOLDOBN6<span style="color:#5bc4bf">&lt;/string&gt;</span>
<span style="color:#5bc4bf">&lt;string</span> <span style="color:#06b6ef">name=</span><span style="color:#48b685">&#34;AWS_SECRET&#34;</span><span style="color:#5bc4bf">&gt;</span>KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S<span style="color:#5bc4bf">&lt;/string&gt;</span>

</code></pre></div><p>AWS CLI is a unified tool to manage your AWS services, this enables one to configure the aws services  through command line and automate them through scripts.
To install <strong>aws-cli</strong> on your linux machine type the following in your desktop terminal.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -m pip install --user awscli
</code></pre></div><p>For adding the aws profile, use the following command in the terminal as shown below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vx@archie:~$ aws configure
AWS Access Key ID <span style="color:#5bc4bf">[</span>None<span style="color:#5bc4bf">]</span>: AKIAZ36DGKTUIOLDOBN6
AWS Secret Access Key <span style="color:#5bc4bf">[</span>None<span style="color:#5bc4bf">]</span>: KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S
</code></pre></div><h3 id="flag9--firebase">Flag9- FireBase</h3>
<h4 id="what-is-firebase">What is firebase?</h4>
<p>Google firebase is a mobile and web application development platform that provides a real-time database that continuously syncs data between the cloud and the userâ€™s mobile devices. Firebase databases are accessible via an API and that if developers have not correctly secured their firebase database, a simple web request can retrieve its entire content.</p>
<p>We need to analyze the FlagNineFirebaseActivity in order to understand how read and write rules are implemented in the application.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#815ba4">public</span> <span style="color:#815ba4">final</span> <span style="color:#fec418">void</span> <span style="color:#06b6ef">goToFlagNineFirebaseActivity</span><span style="color:#5bc4bf">(</span>View view<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
        startActivity<span style="color:#5bc4bf">(</span><span style="color:#815ba4">new</span> Intent<span style="color:#5bc4bf">(</span><span style="color:#815ba4">this</span><span style="color:#5bc4bf">,</span> FlagNineFirebaseActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">class</span><span style="color:#5bc4bf">));</span>
    <span style="color:#5bc4bf">}</span>

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#815ba4">public</span> <span style="color:#06b6ef">FlagNineFirebaseActivity</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">{</span>
    <span style="color:#fec418">byte</span><span style="color:#5bc4bf">[]</span> decode <span style="color:#5bc4bf">=</span> Base64<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">decode</span><span style="color:#5bc4bf">(</span><span style="color:#48b685">&#34;ZmxhZ3Mv&#34;</span><span style="color:#5bc4bf">,</span> 0<span style="color:#5bc4bf">);</span>     <span style="color:#776e71">//  flags/ 
</span><span style="color:#776e71"></span>    <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">v</span> <span style="color:#5bc4bf">=</span> decode<span style="color:#5bc4bf">;</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>decode<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;decodedDirectory&#34;</span><span style="color:#5bc4bf">);</span>
    Charset charset <span style="color:#5bc4bf">=</span> StandardCharsets<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">UTF_8</span><span style="color:#5bc4bf">;</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>charset<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;StandardCharsets.UTF_8&#34;</span><span style="color:#5bc4bf">);</span>
    <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">w</span> <span style="color:#5bc4bf">=</span> <span style="color:#815ba4">new</span> String<span style="color:#5bc4bf">(</span>decode<span style="color:#5bc4bf">,</span> charset<span style="color:#5bc4bf">);</span>
    f b2 <span style="color:#5bc4bf">=</span> f<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">();</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>b2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;FirebaseDatabase.getInstance()&#34;</span><span style="color:#5bc4bf">);</span>
    d d2 <span style="color:#5bc4bf">=</span> b2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">();</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>d2<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;FirebaseDatabase.getInstance().reference&#34;</span><span style="color:#5bc4bf">);</span>
    <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">x</span> <span style="color:#5bc4bf">=</span> d2<span style="color:#5bc4bf">;</span>
    d h <span style="color:#5bc4bf">=</span> d2<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">h</span><span style="color:#5bc4bf">(</span><span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">w</span><span style="color:#5bc4bf">);</span>
    d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">(</span>h<span style="color:#5bc4bf">,</span> <span style="color:#48b685">&#34;database.child(refDirectory)&#34;</span><span style="color:#5bc4bf">);</span>
    <span style="color:#815ba4">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">y</span> <span style="color:#5bc4bf">=</span> h<span style="color:#5bc4bf">;</span>
<span style="color:#5bc4bf">}</span>
</code></pre></div><p>Decode the base64 encoded string in order to understand strings stored in the decode variable. To decode the string we use linux utility called base64.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vx@archie:~$ echo <span style="color:#48b685">&#34;ZmxhZ3Mv&#34;</span> | base64 -d
            flags/
</code></pre></div><p>From the above analysis,we are getting data from firebase storage, in the <strong>flags</strong> node.</p>
<p>Clicking on the hint view button in the application, we get hint on how to solve the challenge level.
When the hint view is clicked it shows a string hint of <strong>&ldquo;Use the .json trick database url&rdquo;</strong> as shown in the decompiled code below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#815ba4">public</span> <span style="color:#815ba4">final</span> <span style="color:#fec418">void</span> <span style="color:#06b6ef">onClick</span><span style="color:#5bc4bf">(</span>View view<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
        String str<span style="color:#5bc4bf">;</span>
        <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>FlagNineFirebaseActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">H</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">==</span> 0<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
            <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>view <span style="color:#5bc4bf">!=</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
                str <span style="color:#5bc4bf">=</span> <span style="color:#48b685">&#34;Use the .json trick with database url&#34;</span><span style="color:#5bc4bf">;</span>
            <span style="color:#5bc4bf">}</span> <span style="color:#815ba4">else</span> <span style="color:#5bc4bf">{</span>
                d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">k</span><span style="color:#5bc4bf">();</span>
                <span style="color:#815ba4">throw</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">;</span>
            <span style="color:#5bc4bf">}</span>
        <span style="color:#5bc4bf">}</span> <span style="color:#815ba4">else</span> <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>FlagNineFirebaseActivity<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">this</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">H</span><span style="color:#5bc4bf">()</span> <span style="color:#5bc4bf">==</span> 1<span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
            <span style="color:#815ba4">if</span> <span style="color:#5bc4bf">(</span>view <span style="color:#5bc4bf">!=</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">)</span> <span style="color:#5bc4bf">{</span>
                str <span style="color:#5bc4bf">=</span> <span style="color:#48b685">&#34;Filenames.&#34;</span><span style="color:#5bc4bf">;</span>
            <span style="color:#5bc4bf">}</span> <span style="color:#815ba4">else</span> <span style="color:#5bc4bf">{</span>
                d<span style="color:#5bc4bf">.</span><span style="color:#06b6ef">m</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">b</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">d</span><span style="color:#5bc4bf">.</span><span style="color:#06b6ef">k</span><span style="color:#5bc4bf">();</span>
                <span style="color:#815ba4">throw</span> <span style="color:#815ba4">null</span><span style="color:#5bc4bf">;</span>
            <span style="color:#5bc4bf">}</span>

</code></pre></div><h4 id="firebase-realtime-rules">Firebase Realtime Rules</h4>
<p>Realtime database stores data as one large JSON tree and synchronized every time a new device is connected.The data received or stored in the database is determined by the security rules  of read and write.</p>
<p>Firebase allows read and write rules to the database to be set to true or false. when <strong>.read</strong> is set to true means describes if and data is allowed to be read by users and <strong>.write</strong> describes if and when data is allowed to be written.
Example of a firebase rule where read and write are allowed.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#5bc4bf">&#34;rules&#34;</span>: {
        <span style="color:#5bc4bf">&#34;.read&#34;</span>: <span style="color:#815ba4">true</span>,
        <span style="color:#5bc4bf">&#34;.write&#34;</span>: <span style="color:#815ba4">true</span>
    }
}
</code></pre></div><p>When read and write rules are enabled means that everyone with access to the application can read and write unauthorized data to the database.</p>
<p>The firebase database url is defined in <strong>strings.xml</strong> file in the resource section.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#5bc4bf">&lt;string</span> <span style="color:#06b6ef">name=</span><span style="color:#48b685">&#34;firebase_database_url&#34;</span><span style="color:#5bc4bf">&gt;</span>https://injuredandroid.firebaseio.com<span style="color:#5bc4bf">&lt;/string&gt;</span>
</code></pre></div><p>The firebase node defined in our instance is <strong>flags</strong> node, to check if the endpoint node is vulnerable we append a <strong>.json</strong> at the end of the url node as shown in the image below.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vx@archie:injured$ curl https://injuredandroid.firebaseio.com/flags/.json
<span style="color:#48b685">&#34;[nine!_flag]&#34;</span>
</code></pre></div><p>If the url returns some data, that means that our endpoint is vulnerable. From the above output we were able to successfully solve the challenge.</p>
<h4 id="securing-firebase">Securing Firebase</h4>
<p>One can secure Firebase database by only allowing users of application to have only read permissions to a certain  tree node instead of allowing read to the root node in the application. This means the applications can not read data from the neighboring nodes.</p>
<div class="highlight"><pre tabindex="0" style="color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#5bc4bf">&#34;rules&#34;</span>: {
    <span style="color:#5bc4bf">&#34;flag&#34;</span>: {
      <span style="color:#5bc4bf">&#34;.read&#34;</span>: <span style="color:#815ba4">true</span>,
      <span style="color:#5bc4bf">&#34;.write&#34;</span>: <span style="color:#815ba4">false</span>
    }
  }
}
</code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/android/">Android</a>
        
            <a href="/tags/appsec/">Appsec</a>
        
    </section>


    </footer>


    
</article>

    

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/android-application-security-series-part-1/">
        
        
            <div class="article-image">
                
                    <img src="/post/androidsec/android.jpg" loading="lazy" data-key="" data-hash="/post/androidsec/android.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Android Application Security Series- Part 1</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 Solar Bits
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.7.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#insecure-storages">Insecure Storages</a>
      <ol>
        <li><a href="#flag7---sqlite">Flag7 - Sqlite</a></li>
        <li><a href="#flag8---aws-storage-and-security">FLag8 - AWS Storage and Security.</a></li>
        <li><a href="#flag9--firebase">Flag9- FireBase</a>
          <ol>
            <li><a href="#what-is-firebase">What is firebase?</a></li>
            <li><a href="#firebase-realtime-rules">Firebase Realtime Rules</a></li>
            <li><a href="#securing-firebase">Securing Firebase</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
